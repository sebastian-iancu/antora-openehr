<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>ADL - Archetype Definition Language :: openEHR Specifications (Local Build)</title>
    <link rel="canonical" href="https://sebastian-iancu.github.io/antora-openehr/AM/Release-2.2.0/ADL2/adl/">
    <link rel="prev" href="../default_values/">
    <link rel="next" href="../terminology_integration/">
    <meta name="description" content="openEHR Archetype Definition Language 2 (ADL2)">
    <meta name="keywords" content="EHR, ADL, AOM, health records, archetypes, constraint language, ISO 13606, openehr">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/antora-openehr.css">
    <link rel="stylesheet" href="../../../../_/css/openehr.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://sebastian-iancu.github.io/antora-openehr">openEHR Specifications (Local Build)</a>

      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field has-filter">
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:AM"> Archetype Model only
          </label>
        </div>
      </div>

      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Specifications</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://specifications.openehr.org/" target="_blank">
              openEHR specification
            </a>
            <a class="navbar-item" href="https://specifications.openehr.org/releases/UML/development/index.html" target="_blank">
              openEHR portal
            </a>
            <a class="navbar-item" href="https://ckm.openehr.org/ckm/" target="_blank">
              openEHR CKM
            </a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://openehr.atlassian.net/secure/Dashboard.jspa?selectPageId=10190" target="_blank">
              Issue trackers
            </a>
            <a class="navbar-item" href="https://discourse.openehr.org/" target="_blank">
              Discourse Forum
            </a>
            <a class="navbar-item" href="https://specifications.openehr.org/wiki/display/spec/Specifications+Home" target="_blank">
              Wiki
            </a>
            <a class="navbar-item" href="https://github.com/openEHR" target="_blank">
              GitHub
            </a>
          </div>
        </div>

      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="AM" data-version="Release-2.2.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../">Archetype Model</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../ADL1.4/">{spec_title}</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/file_encoding/">File Encoding and Character Quoting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/dadl/">dADL - Data ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/cadl/">cADL - Constraint ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/assertions/">Assertions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/paths/">ADL Paths</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/adl/">ADL - Archetype Definition Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/customising_adl/">Customising ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/other_formalisms/">Relationship of ADL to Other Formalisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/masterAppB-extended_metadata/">Extended Meta-data Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/masterAppC-syntax_spec/">Syntax Specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL1.4/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../">{spec_title}</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../file_encoding/">File Encoding and Character Quoting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cadl/">cADL - Constraint ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../paths/">ADL Paths</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../default_values/">Default Values</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">ADL - Archetype Definition Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../terminology_integration/">Terminology Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../specialisation/">Specialisation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../templates/">Templates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../other_formalisms/">Relationship of ADL to Other Formalisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../masterAppB-syntax_spec/">Syntax Specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../AOM1.4/">{spec_title}</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/model_overview/">The Archetype Object Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/archetype_package/">The Archetype Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/constraint_model_package/">Constraint Model Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/assertion_package/">The Assertion Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/primitive_package/">Primitive Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/ontology_package/">Terminology Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/domain_extension/">Domain-specific Extension Example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/masterAppB-diverse_reference_models/">Using Archetypes with Diverse Reference Models</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/masterAppC-rm_dependencies/">Reference Model Dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../AOM2/">{spec_title}</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/model_overview/">Model Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/archetype_package/">The Archetype Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/constraint_model_package/">Constraint Model Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/rules_package/">The Rules Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/rm_overlay/">The RM Overlay Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/terminology_package/">Terminology Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/validation/">Validation and Transformation Semantics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/serialisation_model/">Serialisation Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/templates/">Templates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/rm_adaptation/">Reference Model Adaptation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../Identification/">{spec_title}</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/artefact_source_id/">Source Artefact Identification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/versioning/">Versioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/lifecycle_mgt/">Lifecycle Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/distributed_governance/">Distributed Governance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/referencing/">Referencing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/uris/">A Reliable URI for Knowledge Resources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/artefact_authentication/">Artefact Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/scenarios/">Scenarios</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#index.adoc">Language Design</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../OPT2/">{spec_title}</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/opt_raw/">The Raw Operational Template</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/opt_profiled/">The Profiled Operational Template</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/file_formats/">File Formats</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../Overview/">{spec_title}</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/introduction/">Business Purpose of Archetypes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/formalism_overview/">Archetype Formalism Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/the_specifications/">The Specifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/semantic_overview/">Semantic Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/artefacts/">Artefacts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Archetype Model</span>
    <span class="version">Release-2.2.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../../../latest/">Archetype Model</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../latest/">Release-2.3.0</a>
        </li>
        <li class="version is-current">
          <a href="../../">Release-2.2.0</a>
        </li>
        <li class="version">
          <a href="../../../development/">development</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../BASE/latest/">Base Model</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../BASE/latest/">Release-1.2.0</a>
        </li>
        <li class="version">
          <a href="../../../../BASE/Release-1.1.0/">Release-1.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../BASE/development/">development</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../RM/latest/">Reference Model</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../RM/latest/">Release-1.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../RM/Release-1.0.4/">Release-1.0.4</a>
        </li>
        <li class="version">
          <a href="../../../../RM/development/">development</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../BASE/latest/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../">Archetype Model</a></li>
    <li><a href="../">{spec_title}</a></li>
    <li><a href="./">ADL - Archetype Definition Language</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">Release-2.2.0</button>
  <div class="version-menu">
    <a class="version is-missing" href="../../../latest/">Release-2.3.0</a>
    <a class="version is-current" href="./">Release-2.2.0</a>
    <a class="version is-missing" href="../../../development/">development</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">ADL - Archetype Definition Language</h1>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a><a class="link" href="#_introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes whole ADL artefacts. The relationship of the cADL-encoded <code>definition</code> section and the ODIN-encoded <code>terminology</code> section is discussed in detail.</p>
</div>
<div class="paragraph">
<p>Some syntax valdity rules are defined, but validity in general is defined by the rules stated in the AOM specification, which can be checked by a compiler as soon as an AOM structure is parsed from an ADL document (or other serialsiation format).</p>
</div>
<div class="paragraph">
<p>The general structure of ADL artefacts is as follows (the full definitions are shown in <a href="#Syntax Specification">[Syntax Specification]</a> below):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-antlr-java" data-lang="antlr-java">adl_artefact: artefact_type meta_data?
        ARCHETYPE_HRID
    ('specialize'
        ARCHETYPE_REF)?
    'language'
        odin_text
    'description'
        odin_text
    'definition'
        c_complex_object
    ('rules'
        el_text)?
    ('rm_overlay'
        odin_text)?
    'terminology'
        odin_text
    ('annotations'
        odin_text)?
    ;

artefact_type: 'archetype' | 'template' | 'template_overlay' | 'operational_template' ;

meta_data: '(' meta_data_item  (';' meta_data_item )* ')' ;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax for <code>meta_data_item</code>, <code>ARCHETYPE_HRID</code> and <code>ARCHETYPE_REF</code> can be found below in <a href="#_base_patterns">[_base_patterns]</a>.</p>
</div>
<div class="paragraph">
<p>The 'archetype' artefact type can have any or all of the above sections. The other artefact types are more specific in their form.</p>
</div>
<div class="paragraph">
<p>An ADL source template has the following structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-antlr-java" data-lang="antlr-java">adl_template: 'template' meta_data?
        ARCHETYPE_HRID
    'specialize'
        ARCHETYPE_REF
    'language'
        odin_text
    'description'
        odin_text
    'definition'
        c_complex_object
    ('rules'
        el_text)?
    ('rm_overlay'
        odin_text)?
    'terminology'
        odin_text
    ('annotations'
        odin_text)?
    ;</code></pre>
</div>
</div>
<div class="paragraph">
<p>An ADL template overlay has the structure shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-antlr-java" data-lang="antlr-java">adl_template_overlay: 'template_overlay'
        ARCHETYPE_HRID
    'specialize'
        ARCHETYPE_REF
    'definition'
        c_complex_object
    ('rules'
        el_text)?
    ('rm_overlay'
        odin_text)?
    'terminology'
        odin_text
    ;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The structure of an operational template is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-antlr-java" data-lang="antlr-java">adl_operational_template: 'operational_template' meta_data?
        ARCHETYPE_HRID
    'language'
        odin_text
    'description'
        odin_text
    'definition'
        c_complex_object
    ('rules'
        el_text)?
    ('rm_overlay'
        odin_text)?
    'terminology'
        odin_text
    ('annotations'
        odin_text)?
    'component_terminologies'
        odin_text
    ;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_naming_convention"><a class="anchor" href="#_file_naming_convention"></a><a class="link" href="#_file_naming_convention">File-naming Convention</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Up until ADL 1.4, archetypes were expressed in 'flat' form ADL and were saved in files with the extension <code>.adl</code>. These are now treated as legacy flat format files. Beginning with ADL 2, the source file format of an archetype is the 'differential' form, with the extension <code>.adls</code>. The flat format generated by tools now has the extension <code>.adlf</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_artefact_content"><a class="anchor" href="#_artefact_content"></a><a class="link" href="#_artefact_content">Artefact Content</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>For specialised archetypes, differential form follows the object-oriented convention and only includes overridden or new elements but not unchanged inherited elements. Inherited elements are determined by compiling and 'flattening' a differential archetype with respect to the parent archetypes in its <em>inheritance lineage</em> .</p>
</div>
<div class="paragraph">
<p>For top-level archetypes the full structure is included in the differential file, but internal references, where they exist, are expanded out in the flat form.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basics"><a class="anchor" href="#_basics"></a><a class="link" href="#_basics">Basics</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_keywords"><a class="anchor" href="#_keywords"></a><a class="link" href="#_keywords">Keywords</a></h3>
<div class="paragraph">
<p>ADL has a small number of keywords which are reserved for use in archetype declarations, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>archetype</code>, <code>template</code>, <code>template_overlay</code>, <code>operational_template</code>,</p>
</li>
<li>
<p><code>specialise</code> / <code>specialize</code>,</p>
</li>
<li>
<p><code>language</code> ,</p>
</li>
<li>
<p><code>description</code> , <code>definition</code> , <code>rules</code> , <code>terminology</code></p>
</li>
<li>
<p><code>annotations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of these words can safely appear as identifiers in the <code>definition</code> and <code>terminology</code> sections.</p>
</div>
<div class="paragraph">
<p>Deprecated keywords include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>invariant</code>&#8201;&#8212;&#8201;replaced by <code>rules</code></p>
</li>
<li>
<p><code>ontology</code> &#8201;&#8212;&#8201;replaced by <code>terminology</code></p>
</li>
<li>
<p><code>concept</code>  &#8201;&#8212;&#8201;obsolete</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_artefact_declaration"><a class="anchor" href="#_artefact_declaration"></a><a class="link" href="#_artefact_declaration">Artefact declaration</a></h3>
<div class="paragraph">
<p>The first word in a source ADL archetype declares the artefact type, and is one of the following keywords:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>archetype</code>:        signifies an archetype;</p>
</li>
<li>
<p><code>template</code>:         signifies a template;</p>
</li>
<li>
<p><code>template_overlay</code>: signifies an overlay component of a template.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The flattened form of any of the above types starts with the keyword 'flat' followed by the artefact type.</p>
</div>
<div class="paragraph">
<p>A fourth artefact type is also possible.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>operational_archetype</code>: signifies an operational archetype, generated by flattening a template.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_node_identifier_codes"><a class="anchor" href="#_node_identifier_codes"></a><a class="link" href="#_node_identifier_codes">Node Identifier Codes</a></h3>
<div class="paragraph">
<p>In the <code>definition</code> section of an ADL archetype, a specific set of codes is used as node identifiers. Identifier codes always appear in brackets (<code>[]</code> ), and begin with the 'id' prefix. Specialisations of locally coded concepts have the same root, followed by 'dot' extensions, e.g. <code>[id10.2]</code> . From a terminology point of view, these codes have no implied semantics - the 'dot' structuring is used as an optimisation on node identification.</p>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: In ADL 1.4 at-codes were used as node identifiers. These are converted to id-codes by ADL 1.4 to ADL 2 converters.</p>
</div>
</div>
<div class="sect2">
<h3 id="_local_term_codes"><a class="anchor" href="#_local_term_codes"></a><a class="link" href="#_local_term_codes">Local Term Codes</a></h3>
<div class="paragraph">
<p>In the <code>definition</code> section of an ADL archetype, a second set of codes is used for terms denoting constraints on coded items. Term codes are either local to the archetype, or from an external lexicon. This means that the archetype description is the same in all languages, and is available in any language that the codes have been translated to. All term codes are shown in brackets (<code>[]</code>) and are prefixed with "at", e.g. <code>at10</code> . Codes of any length are acceptable in ADL archetypes. Specialisations of locally coded concepts have the same root, followed by 'dot' extensions, e.g. <code>at10.2</code> . From a terminology point of view, these codes have no implied semantics - the 'dot' structuring is used as an optimisation on node identification.</p>
</div>
</div>
<div class="sect2">
<h3 id="_local_value_set_codes"><a class="anchor" href="#_local_value_set_codes"></a><a class="link" href="#_local_value_set_codes">Local Value Set Codes</a></h3>
<div class="paragraph">
<p>A third kind of local code is used to stand for value set constraints on coded text items in the body of the archetype. Because they are language- and/or terminology-sensitive, they are defined in the terminology section, and referenced by codes prefixed by "ac", e.g. <code>[ac9]</code>.</p>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: In ADL 1.4 and transitional forms of ADL 1.5/2, 0-padded 'at' and 'ac' codes were used within top-level archetypes. In ADL 2, all such codes are reformatted to remove the 0-padding.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_archetype_identification_section"><a class="anchor" href="#_archetype_identification_section"></a><a class="link" href="#_archetype_identification_section">Archetype Identification Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section introduces the archetype with the keyword <code>archetype</code>, <code>template</code>, <code>template_overlay</code> or <code>operational_archetype</code>, followed by a number of items of meta-data in parentheses, and on the next line, a human-readable archetype identifier. The following shows an identification section with all possible meta-data items.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=2.0.5; rm_release=1.0.3; provenance_id=15E82D77-7DB7-4F70-8D8E-EED6FF241B2D; build_uid=E163E472-3E90-409C-9803-0668A7DA48CE; generated; controlled)
    openEHR-EHR-OBSERVATION.haematology_result.v0.1.9</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_adl_version_indicator"><a class="anchor" href="#_adl_version_indicator"></a><a class="link" href="#_adl_version_indicator">ADL Version Indicator</a></h3>
<div class="paragraph">
<p>An ADL version identifier is mandatory in all archetypes, and is expressed as a string of the form <code>adl_version=N.M</code> , or <code>N.M.P</code>, where <code>N.M[.P]</code> is the ADL release identifier.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rm_release_indicator"><a class="anchor" href="#_rm_release_indicator"></a><a class="link" href="#_rm_release_indicator">RM Release Indicator</a></h3>
<div class="paragraph">
<p>An RM (Reference Model) Release identifier is mandatory in all archetypes, and is expressed as a string of the form <code>rm_release=N.M</code>, or <code>N.M.P</code>, where the version number indicates the release of the reference model on which the archetype is based.</p>
</div>
</div>
<div class="sect2">
<h3 id="_machine_identifiers"><a class="anchor" href="#_machine_identifiers"></a><a class="link" href="#_machine_identifiers">Machine Identifiers</a></h3>
<div class="paragraph">
<p>A unique identifier for the archetype in the form of a GUID can be specified using the syntax below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=2.0.5; rm_release=1.0.3; uid=15E82D77-7DB7-4F70-8D8E-EED6FF241B2D)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This identifier is set at initial creation or at any time later, and never subsequently changes. It acts as an identifier for the physical artefact, regardless of what semantics are changed, including changes to the constituent parts of the multi-axial identifier.</p>
</div>
<div class="paragraph">
<p>A <code>build_uid</code> identifier can also be specified, with a GUID value, identifying the current artefact. This identifier changes whenever any change is made to the text of the archetype, and can thus be used to disambiguate subsequent versions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_namespaces"><a class="anchor" href="#_namespaces"></a><a class="link" href="#_namespaces">Namespaces</a></h3>
<div class="paragraph">
<p>A namespaced archetype has an identification section like the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=2.0.5; rm_release=1.0.2)
    br.gov.saude::openEHR-EHR-OBSERVATION.haematology_result.v1.0.0

template (adl_version=2.0.5; rm_release=1.0.2)
    uk.org.primary_care::openEHR-EHR-OBSERVATION.haematology_result.v1.2.15

archetype (adl_version=2.0.5; rm_release=1.0.2)
    org.openehr::openEHR-EHR-OBSERVATION.haematology_result.v3.22.125-rc.7</code></pre>
</div>
</div>
<div class="paragraph">
<p>Namespaces are used to distinguish locally created artefacts representing a given concept (such as 'haematology result') from an artefact created elsewhere intended to represent the same concept.</p>
</div>
<div class="paragraph">
<p>Once a namespace is attached to an archetype, it is considered a part of the identifier, and never changed, even if the archetype moves to a new publishing organisation. This ensures the constant relationship between archetypes and the data created using them.</p>
</div>
</div>
<div class="sect2">
<h3 id="_human_readable_archetype_identifier"><a class="anchor" href="#_human_readable_archetype_identifier"></a><a class="link" href="#_human_readable_archetype_identifier">Human Readable Archetype Identifier</a></h3>
<div class="paragraph">
<p>The archetype identifier may include a namespace, in the form of a reverse domain name, which denotes the original authoring organisation. The lack of a namespace in the identifier indicates an ad hoc, uncontrolled artefact, not formally associated with any organisation, typical for experimental archetypes, and pre-ADL 1.5 archetypes not yet upgraded to have a namespace. The main part of the identifier is multi-axial concept identifier.</p>
</div>
<div class="paragraph">
<p>A typical identification sectionfor an ad hoc archetype is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=2.0.5; rm_release=1.0.2)
    openEHR-EHR-OBSERVATION.haematology_result.v0.1.9</code></pre>
</div>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: In ADL 1.4 and transitional forms of ADL 1.5, archetype identifiers included only a single version number, and this typically started at 1. Tools that deal with older archetypes should accept these identifiers, and convert the version part to 'v1.0.0' or any other appropriate identifier, obeying the openEHR Artefact Knowledge Identification specification.</p>
</div>
<div class="paragraph">
<p>The multi-axial archetype identifier identifies archetypes in a global concept space within a given namespace. It is also known as an 'ontological' identifier, since the concept space can be understood as an ontology of informational concepts on which the archetypes are based. The syntax of the identifier is described in the <a href="https://specifications.openehr.org/releases/AM/latest/Identification.html">openEHR Identification Specification</a>. The structure of the concept space is essentially two-level, with the first level being a reference model class (e.g. openEHR <code>OBSERVATION</code> class) and the second being a domain concept (e.g. 'haematology result').</p>
</div>
<div class="paragraph">
<p>Because namespaces are usually treated hierarchically, higher level namespaces (e.g. '.org' domains) are assumed to be includable by more local namespaces, with the result that the concept definition space is inherited as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specialised_archetype_identification"><a class="anchor" href="#_specialised_archetype_identification"></a><a class="link" href="#_specialised_archetype_identification">Specialised Archetype Identification</a></h3>
<div class="paragraph">
<p>The archetype identifier of any specialised archetype, including all templates, follows the same rules as for non-specialised archetypes.</p>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: in previous versions of ADL, the archetype identifier of a specialised archetype had a concept part that consisted of the concept part of the parent followed by '-' and a further specialised concept. For example, <code>openEHR-EHR-OBSERVATION.haematology-cbc. v1</code> was a valid child of <code>openEHR-EHR-OBSERVATION.haematology.v1</code>. This restriction is no longer the case. The previous style of identifier is still legal, but the '-' no longer has any significance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_version_identifiers"><a class="anchor" href="#_version_identifiers"></a><a class="link" href="#_version_identifiers">Version Identifiers</a></h3>
<div class="paragraph">
<p>ADL 2 Archetypes contain 3-part version identifiers, with optional qualifiers, following the openEHR Artefact Knowledge Identification specification. Examples below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">    br.ms::openEHR-EHR-OBSERVATION.haematology_result.v1.0.0
    br.ms::openEHR-EHR-OBSERVATION.haematology_result.v1.2.15-alpha.45
    br.ms::openEHR-EHR-OBSERVATION.haematology_result.v3.22.125-rc.7</code></pre>
</div>
</div>
<div class="paragraph">
<p>The version identifier variants are summarised as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>N.M.P</code>         - 3-part version id with no qualifier indicates major.minor.path version</p>
</li>
<li>
<p><code>N.M.P-alpha.N</code> - a <code>-alpha.N</code> qualifier indicates uncontrolled changes on <code>N.M.P</code> , leading to a new version that is yet to be decided</p>
</li>
<li>
<p><code>N.M.P-rc.N</code>    - a <code>-rc.N</code> qualifier indicates a release candidate.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_validity"><a class="anchor" href="#_validity"></a><a class="link" href="#_validity">Validity</a></h3>
<div class="paragraph">
<p>The following syntax validity rule applies in the identification section:</p>
</div>
<div class="paragraph rule">
<p>SARID: archetype identifier validity. the identifier of the artefact must conform to the ARCHETYPE_ID identifier syntax defined in the <a href="https://specifications.openehr.org/releases/BASE/latest/base_types.html">openEHR BASE/Base Types Specification</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_generated_indicator"><a class="anchor" href="#_generated_indicator"></a><a class="link" href="#_generated_indicator">Generated Indicator</a></h3>
<div class="paragraph">
<p>A flag indicating whether the archetype was generated or authored can be included after the version, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=2.0.5; rm_release=1.0.2; generated)
    org.openehr::openEHR-EHR-OBSERVATION.haematology.v1.2.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>This marker is used to support the migration to differential archetype representation introduced in ADL 1.5, to enable proper representation of specialised archetypes. The 'generated' marker can be used on specialised archetypes - i.e. ADL 1.5 style .adls files - generated from flat archetypes - ADL 1.4 .adl files - and also in flat archetypes generated from differential files, by an inheritance-flattening process.</p>
</div>
</div>
<div class="sect2">
<h3 id="_controlled_indicator"><a class="anchor" href="#_controlled_indicator"></a><a class="link" href="#_controlled_indicator">Controlled Indicator</a></h3>
<div class="paragraph">
<p>A flag indicating whether the archetype is change-controlled or not can be included after the version, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=2.0.5; rm_release=1.0.2; controlled)
    org.openehr::openEHR-EHR-OBSERVATION.haematology.v1.2.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>This flag may have the two values "controlled" and "uncontrolled" only, and is an aid to software. Archetypes that include the "controlled" flag should have the revision history section included, while those with the "uncontrolled" flag, or no flag at all, may omit the revision history. This enables archetypes to be privately edited in an early development phase without generating large revision histories of little or no value.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specialise_section"><a class="anchor" href="#_specialise_section"></a><a class="link" href="#_specialise_section">Specialise Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This optional section indicates that the archetype is a specialisation of some other archetype, whose identity must be given. Only one specialisation parent is allowed, i.e. an archetype cannot 'multiply-inherit' from other archetypes. An example of declaring specialisation is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=2.0.5; rm_release=1.0.2)
    openEHR-EHR-OBSERVATION.cbc.v1.0.0
specialise
    openEHR-EHR-OBSERVATION.haematology.v1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the identifier of the new archetype is derived from that of the parent by adding a new section to its domain concept section. See the <code>ARCHETYPE_ID</code> definition in the identification package in the openEHR Support IM specification.</p>
</div>
<div class="paragraph">
<p>Note that both the US and British English versions of the word "specialise" are valid in ADL.</p>
</div>
<div class="paragraph">
<p>The following syntax validity rule applies in the specialisation section:</p>
</div>
<div class="paragraph rule">
<p>SASID: archetype specialisation parent identifier validity. for specialised artefacts, the identifier of the specialisation parent must conform to the ARCHETYPE_ID identifier syntax defined in the openEHR Support IM Specification.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_language_section"><a class="anchor" href="#_language_section"></a><a class="link" href="#_language_section">Language Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>language</code> section includes meta-data describing the original language in which the archetype was authored (essential for evaluating natural language quality), and the total list of languages available in the archetype. There can be only one <code>original_language</code> . The <code>translations</code> list must be updated every time a translation of the archetype is undertaken. The following shows a typical example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">language
    original_language = &lt;[iso_639-1::en]&gt;
    translations = &lt;
        ["de"] = &lt;
            language = &lt;[iso_639-1::de]&gt;
            author = &lt;
                ["name"] = &lt;"Frederik Tyler"&gt;
                ["email"] = &lt;"freddy@something.somewhere.co.uk"&gt;
            &gt;
            accreditation = &lt;"British Medical Translator id 00400595"&gt;
        &gt;
        ["ru"] = &lt;
            language = &lt;[iso_639-1::ru]&gt;
            author = &lt;
                ["name"] = &lt;"Nina Alexandrovna"&gt;
                ["organisation"] = &lt;"Dostoevsky Media Services"&gt;
                ["email"] = &lt;"nina@translation.dms.ru"&gt;
            &gt;
            accreditation = &lt;"Russian Translator id 892230-3A"&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Archetypes must always be translated completely, or not at all, to be valid. This means that when a new translation is made, every language dependent section of the <code>description</code> and <code>terminology</code> sections has to be translated into the new language, and an appropriate addition made to the <code>translations</code> list in the language section.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
some non-conforming ADL tools in the past created archetypes without a language section, relying on the terminology section to provide the original_language (there called primary_language) and list of languages (languages_available). In the interests of backward compatibility, tool builders should consider accepting archetypes of the old form and upgrading them when parsing to the correct form, which should then be used for serialising/saving.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_description_section"><a class="anchor" href="#_description_section"></a><a class="link" href="#_description_section">Description Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>description</code> section of an archetype contains descriptive information, or what some people think of as document "meta-data", i.e. items that can be used in repository indexes and for searching. The ODIN syntax is used for the description, as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">description
    original_author = &lt;
        ["name"] = &lt;"Dr J Joyce"&gt;
        ["organisation"] = &lt;"NT Health Service"&gt;
        ["date"] = &lt;2003-08-03&gt;
    &gt;
    lifecycle_state =  &lt;"initial"&gt;
    resource_package_uri =  &lt;"http://www.aihw.org.au/data_sets/diabetic_archetypes.html"&gt;

    details = &lt;
        ["en"] = &lt;
            language = &lt;[iso_639-1::en]&gt;
            purpose =  &lt;"archetype for diabetic patient review"&gt;
            use = &lt;"used for all hospital or clinic-based diabetic reviews,
                including first time. Optional sections are removed according to the particular review"&gt;
            misuse = &lt;"not appropriate for pre-diagnosis use"&gt;
            original_resource_uri = &lt;"http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html"&gt;
            other_details = &lt;...&gt;
        &gt;
        ["de"] = &lt;
            language = &lt;[iso_639-1::de]&gt;
            purpose =  &lt;"Archetyp f체r die Untersuchung von Patienten mit Diabetes"&gt;
            use = &lt;"wird benutzt f체r alle Diabetes-Untersuchungen im
                    Krankenhaus, inklusive der ersten Vorstellung. Optionale
                    Abschnitte werden in Abh채ngigkeit von der speziellen
                    Vorstellung entfernt."&gt;
            misuse = &lt;"nicht geeignet f체r Benutzung vor Diagnosestellung"&gt;
            original_resource_uri = &lt;"http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html"&gt;
            other_details = &lt;...&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A number of details are worth noting here. Firstly, the free hierarchical structuring capability of ODIN is exploited for expressing the 'deep' structure of the <code>details</code> section and its subsections. Secondly, the ODIN qualified list form is used to allow multiple translations of the <code>purpose</code> and <code>use</code> to be shown. Lastly, empty items such as <code>misuse</code> (structured if there is data) are shown with just one level of empty brackets. The above example shows meta-data based on the <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html">openEHR Archetype Object Model (AOM)</a>.</p>
</div>
<div class="paragraph">
<p>The <code>description</code> section is technically optional according to the AOM, but in any realistic use of ADL for archetypes, it will be required. A minimal description section satisfying to the AOM is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">description
    original_author = &lt;
        ["name"] = &lt;"Dr J Joyce"&gt;
        ["organisation"] = &lt;"NT Health Service"&gt;
        ["date"] = &lt;2003-08-03&gt;
    &gt;
    lifecycle_state = &lt;"initial"&gt;
    details = &lt;
        ["en"] = &lt;
            language = &lt;[iso_639-1::en]&gt;
            purpose = &lt;"archetype for diabetic patient review"&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deprecated_sections"><a class="anchor" href="#_deprecated_sections"></a><a class="link" href="#_deprecated_sections">Deprecated Sections</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_concept_section"><a class="anchor" href="#_concept_section"></a><a class="link" href="#_concept_section">Concept Section</a></h3>
<div class="paragraph">
<p>A 'concept' section was required up until ADL 1.4. In ADL 1.5, the concept section is deprecated, but allowed, enabling ADL 1.4 archetypes to be treated as valid. It will be removed in a future version of ADL, since it is completely redundant.</p>
</div>
<div class="paragraph">
<p>All archetypes represent some real world concept, such as a "patient", a "blood pressure", or an "ante-natal examination". The concept is always coded, ensuring that it can be displayed in any language the archetype has been translated to. A typical <code>concept</code> section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>concept [at0000] -- haematology result</pre>
</div>
</div>
<div class="paragraph">
<p>In this concept definition, the term definition of <code>[at0000]</code> is the proper description corresponding to the "haematology-cbc" section of the archetype identifier above.</p>
</div>
<div class="paragraph">
<p>The following syntax validity rule applies to the concept section, if present, allowing parsers to correctly ignore it:</p>
</div>
<div class="paragraph rule">
<p>SACO: archetype concept validity: if a concept section is present, it must consist of the 'concept' keyword and a single local term.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_definition_section"><a class="anchor" href="#_definition_section"></a><a class="link" href="#_definition_section">Definition Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>definition</code> section contains the main formal definition of the archetype, and is written in the Constraint Definition Language (cADL). A typical <code>definition</code> section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">definition
    OBSERVATION[id1]  {                                                 -- blood pressure measurement
        name  {                                                         -- any synonym of BP
            DV_CODED_TEXT[id2]  {
                defining_code  {
                    CODE_PHRASE[id3]  {[ac1]}
                }
            }
        }
        data  {
            HISTORY[id4]  {                                              -- history
                events cardinality  {1..*}  {
                    POINT_EVENT[id5] occurrences  {0..1}  {            -- baseline
                        name  {
                            DV_CODED_TEXT[id6]  {
                                defining_code  {
                                    CODE_PHRASE[id7]  {[ac2]}
                                }
                            }
                        }
                        data  {
                            ITEM_LIST[id8]  {                              -- systemic arterial BP
                                items cardinality  {2..*}  {
                                    ELEMENT[id9]  {                        -- systolic BP
                                        name  {                            -- any synonym of 'systolic'
                                            DV_CODED_TEXT[id10]  {
                                                defining_code  {
                                                    CODE_PHRASE[id11]  {[ac2]}
                                                }
                                            }
                                        }
                                        value  {
                                            DV_QUANTITY[id12]  {
                                                magnitude  {|0..1000|}
                                                property  {[properties::944]}  -- "pressure"
                                                units  {[units::387]}          -- "mm[Hg]"
                                            }
                                        }
                                    }
                                    ELEMENT[id79]  {                            -- diastolic BP
                                        name  {                                 -- any synonym of 'diastolic'
                                            DV_CODED_TEXT[id14]  {
                                                defining_code  {
                                                    CODE_PHRASE[id15]  {[ac3]}
                                                }
                                            }
                                        }
                                        value  {
                                            DV_QUANTITY[id16]  {
                                                magnitude  {|0..1000|}
                                                property  {[properties::944]}   -- "pressure"
                                                units  {[units::387]}           -- "mm[Hg]"
                                            }
                                        }
                                    }
                                    ELEMENT[id17] occurrences  {0..*}  {*}    -- unknown new item
                                }
                            ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This definition expresses constraints on instances of the types <code>ENTRY</code> , <code>HISTORY</code> , <code>EVENT</code> , <code>ITEM_LIST</code> , <code>ELEMENT</code> , <code>QUANTITY</code> , and <code>CODED_TEXT</code> so as to allow them to represent a blood pressure measurement, consisting of a history of measurement events, each consisting of at least systolic and diastolic pressures, as well as any number of other items (expressed by the <code>[id17]</code> "any" node near the bottom).</p>
</div>
<div class="sect2">
<h3 id="_design_time_and_run_time_paths"><a class="anchor" href="#_design_time_and_run_time_paths"></a><a class="link" href="#_design_time_and_run_time_paths">Design-time and Run-time paths</a></h3>
<div class="paragraph">
<p>All archetype object constraint nodes require a node identifier. When data are created according to the <code>definition</code> section of an archetype, the archetype node identifiers can be written into the data, providing a reliable way of finding data nodes, regardless of what other runtime names might have been chosen by the user for the node in question. There are two reasons for doing this. Firstly, querying cannot rely on runtime names of nodes (e.g. names like "sys BP", "systolic bp", "sys blood press." entered by a doctor are unreliable for querying); secondly, it allows runtime data retrieved from a persistence mechanism to be re-associated with the cADL structure which was used to create it.</p>
</div>
<div class="paragraph">
<p>An example which shows the difference between design-time meanings associated with node identifiers and runtime names is the following, from a <code>SECTION</code> archetype representing the problem/SOAP headings (a simple heading structure commonly used by clinicians to record patient contacts under top-level headings corresponding to the patient&#8217;s problem(s), and under each problem heading, the headings "subjective", "objective", "assessment", and "plan").</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cadl" data-lang="cadl">    SECTION[id1] matches {                          -- problem
        name matches {
            DV_CODED_TEXT[id2] matches {
                defining_code matches {[ac1]}       -- any clinical problem type
            }
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the node identifier <code>[id1]</code> is assigned a meaning such as "clinical problem" in the archetype terminology section. The subsequent lines express a constraint on the runtime <em>name</em> attribute, using the internal code <code>[ac1]</code> . The constraint <code>[ac1]</code> is also defined in the archetype terminology section with a formal statement meaning "any clinical problem type", which could clearly evaluate to thousands of possible values, such as "diabetes", "arthritis" and so on. As a result, in the runtime data, the node identifier corresponding to "clinical problem" and the actual problem type chosen at runtime by a user, e.g. "diabetes", can both be found. This enables querying to find all nodes with meaning "problem", or all nodes describing the problem "diabetes". Internal <code>[acNNNN]</code> codes are described in <a href="#Local Constraint Codes">[Local Constraint Codes]</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rules_section"><a class="anchor" href="#_rules_section"></a><a class="link" href="#_rules_section">Rules Section</a></h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the <code>rules</code> section as described below should not yet be considered stable, and it is expected that the use of inline paths will be replaced by separate bindings of symbolic variables to paths, along with rules for the semantics of such bindings.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>rules</code> section in an ADL archetype contains <em>statements</em> representing assertions and computational expressions that relate to the entire archetype. Assertions in the <code>rules</code> section represent constraints that are not possible within the block structure of the <code>definition</code> section. Any constraint that references more than one property is in this category, as are constraints or expressions containing mathematical or logical formulae. Archetype rules are a subset of the openEHR Expression Language, described in the <a href="https://specifications.openehr.org/releases/BASE/Release-1.0.4/expression.html" target="_blank" rel="noopener">openEHR Expression Language specification</a>.</p>
</div>
<div class="sect2">
<h3 id="_assertions"><a class="anchor" href="#_assertions"></a><a class="link" href="#_assertions">Assertions</a></h3>
<div class="paragraph">
<p>Semantically, an assertion is a first order predicate logic statement which can be evaluated to a Boolean result at runtime. Objects and properties are referred to using paths within an assertion.</p>
</div>
<div class="paragraph">
<p>A reference to an object in data, including a leaf value, is expressed using an archetype path. All such paths are absolute (i.e. contain a leading '/') and are understood to be with respect to the root of the current archetype.</p>
</div>
<div class="paragraph">
<p>Types of assertions used in archetypes include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>arithmetic identities</em>: constraints involving more than one node in an archetype, such as an assertion stating that the sum of the five 0-2 value scores in an Apgar test (heartrate, breathing, muscle tone, reflex, colour) is equal to the Apgar total, recorded in a sixth node;</p>
</li>
<li>
<p><em>mathematical formulae</em>: constraints involving a mathematical formulae that relate various items together, e.g. the pulse pressure and mean arterial pressure formulae used in cardiology;</p>
</li>
<li>
<p><em>value-dependent existence</em>: in some cases optional archetype nodes are intended to be mandatory (or occasionally non-existent) if some other element within the same archetype has a specific value, for example a sub-tree that records details of 'tobacco use' may be considered mandatory if an earlier Boolean node representing 'tobacco user?' has a positive value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these is described below.</p>
</div>
<div class="sect3">
<h4 id="_arithmetic_identities"><a class="anchor" href="#_arithmetic_identities"></a><a class="link" href="#_arithmetic_identities">Arithmetic Identities</a></h4>
<div class="paragraph">
<p>Assertions can be stated that make explicit intended arithmetic identities among value nodes in an archetype. For example, in an archetype representing <a href="https://en.wikipedia.org/wikiApgar_score">Apgar Score</a>, five values should sum to equal the total. This can be expressed as the following assertions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rules
	$respiratory_effort: Integer := /data[id3]/events[id4]/data[id2]/items[id10]/value[id39]/value
    $heart_rate: Integer := /data[id3]/events[id4]/data[id2]/items[id6]/value[id40]/value
    $muscle_tone: Integer := /data[id3]/events[id4]/data[id2]/items[id14]/value[id41]/value
    $reflex_irritability: Integer := /data[id3]/events[id4]/data[id2]/items[id18]/value[id42]/value
    $skin_colour: Integer := /data[id3]/events[id4]/data[id2]/items[id22]/value[id43]/value
    $apgar_score: Integer := /data[id3]/events[id4]/data[id2]/items[id26]/value[id44]/magnitude

    Apgar_total: $apgar_score = $respiratory_effort + $heart_rate + $muscle_tone + $reflex_irritability + $skin_colour</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mathematical_formulae"><a class="anchor" href="#_mathematical_formulae"></a><a class="link" href="#_mathematical_formulae">Mathematical Formulae</a></h4>
<div class="paragraph">
<p>The following ADL example shows a <code>rules</code> section containing the Blood Pressure MAP and Pulse pressure formulae expressed using references to the relevant input and output values in the archetype.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rules
    $pulse_pressure: Real := /data[id2]/events[id7]/data[id4]/items[id1008]/value/magnitude
    $mean_arterial_pressure: Real := /data[id2]/events[id7]/data[id4]/items[id1007]/value/magnitude
    $systolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id5]/value/magnitude
    $diastolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id6]/value/magnitude

	MAP_valid: $mean_arterial_pressure = $diastolic_value + 0.33 * ($systolic_value - $diastolic_value)

	pulse_pressure: $pulse_pressure = $systolic_value - $diastolic_value</pre>
</div>
</div>
<div class="paragraph">
<p>These assertions can be visualised in tools, e.g. as follows in the <a href="https://www.openehr.org/downloads/ADLworkbench">ADL Workbench</a>.</p>
</div>
<div id="assertions_bp_map_pp.png" class="imageblock text-center unresolved text-center">
<div class="content">
<img src="{images_uri}/assertions_bp_map_pp.png" alt="assertions bp map pp" width="70%">
</div>
<div class="title">Figure 1. ADL assertion examples</div>
</div>
<div class="paragraph">
<p>More complex assertions make use of <em>variable sub-paths</em> and the <code>for_all</code> operator to check multiple values in a repeated structure, as in this example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    -- ensure that each mean arterial pressure value in a series of blood pressures
    -- has the correct value.
	for_all $event : /data[id2]/events
		$event/data[id4]/items[id1007]/value/magnitude =
			$event/data[id4]/items[id6]/value/magnitude + 0.33 *
                ($event/data[id4]/items[id5]/value/magnitude - $event/data[id4]/items[id6]/value/magnitude)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the evolution toward separation of data context paths and expressions will enable this kind of expression to be made more readable in future.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_value_dependent_existence"><a class="anchor" href="#_value_dependent_existence"></a><a class="link" href="#_value_dependent_existence">Value-dependent Existence</a></h4>
<div class="paragraph">
<p>One specific type of logical expression that is commonly required in archetypes is used to state the mandation (or otherwise) of certain data points as conditional on another specific data point. An example is an archetype that documents Tobacco use. This will normally contain a data point representing substance 'use status', which may have values such as 'never used', 'occasional user', 'frequent user', etc; and another set of data points quantifying the use. Clearly, if the 'use status' is 'never', the latter set of data is not needed; conversely, if 'use status' is any other value, the quantifying data items are needed. To make them mandatory if the 'use status' is any value other than 'never used', rules like the following can be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rules
    $substance_use_status: Boolean := /data[id2]/items[id3]/value[id18]
    $substance_use_data: Object_ref := /data[id2]/items[id8|details of use|]

    Substance_use: $substance_use_status /= [at17|never used|] implies
        exists /data[id2]/items[id8|details of use|]</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_computational_statements"><a class="anchor" href="#_computational_statements"></a><a class="link" href="#_computational_statements">Computational Statements</a></h3>
<div class="paragraph">
<p>The <code>rules</code> section may also include computational statements that can be used to compute values for specific fields, generally based on some published algorithm, rather than just asserting a relationship between various fields. The following shows a set of statements similar to the example above, but with the field bound to <code>$mean_arterial_pressure</code> now having its value set, not just tested. The assignment operator (<code>:=</code>) is used to achieve this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rules
    $mean_arterial_pressure: Real := /data[id2]/events[id7]/data[id4]/items[id1007]/value/magnitude
    $systolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id5]/value/magnitude
    $diastolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id6]/value/magnitude

	$mean_arterial_pressure := $diastolic_value + 0.33 * ($systolic_value - $diastolic_value)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rm_overlay_section"><a class="anchor" href="#_rm_overlay_section"></a><a class="link" href="#_rm_overlay_section">RM Overlay Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most content in an archetype consists of constraints expressed as an attribute/object structure based on a Reference Model. However, sometimes related meta-data need to be stated with respect to unconstrained RM attributes and paths. Such statements can be made in the <code>rm_overlay</code> section of an archetype, which is designed to be extensible. Specific categories of statement or constraint relating to RM attribute paths can be stated within dedicated sub-sections.</p>
</div>
<div class="sect2">
<h3 id="_rm_visibility"><a class="anchor" href="#_rm_visibility"></a><a class="link" href="#_rm_visibility">RM Visibility</a></h3>
<div class="paragraph">
<p>One of the basic characteristics of any underlying information model which may be archetyped is that its class attributes are already named, typically in English, if the model is internationally shared or standardised. Archetyping solves effective renaming and language-independence of object nodes, via the mechanism of id-codes, but attribute names are by default unchangeable and mono-lingual. Experience in archetype-based modelling has shown that renaming of RM attributes within the context of an archetype is a common need, usually because the attribute name chosen in the original model is not sufficiently specific for some users of a particular archetype. An example is the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#\_composition_package" target="_blank" rel="noopener">openEHR class <code>COMPOSITION</code></a>, which has an attribute <code><em>composer</em></code>. For particular archetypes corresponding to specific sub-domains in healthcare, or specific geographies, a preferable name may be <code><em>author</em></code>; additionally, any such name (even the original) may be needed in multiple languages.</p>
</div>
<div class="paragraph">
<p>In ADL, re-labelling of RM attributes is called <em>aliasing</em>, and is achieved by mentioning an RM attribute path in the archetype and associating an alias with it, in the form of an at-code, defined according to the usual rules of specialisation. Aliasing may apply to any valid RM path in the archetype, i.e. any path through RM objects referenced in the archetype. If archetype-specific nodes are referenced in a path, the settings relate to those paths only in the data, but if not, the settings relate to any matching RM path through the data.</p>
</div>
<div class="paragraph">
<p>A second need, related to the above, is that archetype modellers sometimes need to know what elements are already in an information model, so they don&#8217;t try to remodel them again as redundant object nodes. In a simple implementation of an archetype authoring tool, attributes not so far archetyped will be all hidden, perhaps with a possibility of showing them all. However, commonly, finer-grained control is needed whereby particular attributes, possibly only on <em>particular object nodes</em> need to be made visible in a modelling tool, in order to indicate they need not be modelled.</p>
</div>
<div class="paragraph">
<p>For this reason a 'show' marker can be associated with the path of an non-constrained RM attribute, causing it to be made visible in a modelling tool. Taking into account archetype and template specialisation, it should also be possible to add a 'hide' marker, in order to hide an attribute marked as 'show' in a specialisation parent. It has also been found by experience that sometimes a constrained RM attribute from a parent archetype needs to be hidden in a specialisation child. Thus, the general case is that 'hide' and 'show' markers can be associated with any RM attribute path (constrained or unconstrained) in the archetype.</p>
</div>
<div class="paragraph">
<p>Since both of these needs relate to the visibility of RM attributes in an archetype, and are specfied in terms of RM attribute paths, an <code>rm_overlay</code> sub-section called <code>rm_visibility</code> is used to specify them. The following example illustrates the use of this section to force visibility and aliasing of one attribute, and hiding of another attribute within an archetype.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">rm_overlay
    rm_visibility = &lt;
        ["/path/to[id4]/archetype/node[id213]/path/to/rm/attribute"] = &lt;
            visibility = &lt;"show"&gt;
            alias = &lt;[local::at12]&gt;
        &gt;
        ["/path/to[id5]/archetype/node[id64]/path/to/rm/attribute"] = &lt;
            visibility = &lt;"hide"&gt;
        &gt;
    &gt;

terminology
    term_definitions = &lt;
        ["en"] = &lt;
            ["at12"] = &lt;
                text = &lt;"name in English"&gt;
                description = &lt;"description in English"&gt;
            &gt;
            ...
        &gt;
        ["de"] = &lt;
            ["at12"] = &lt;
                text = &lt;"name in German"&gt;
                description = &lt;"description in German"&gt;
            &gt;
            ...
        &gt;
    &gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_terminology_section"><a class="anchor" href="#_terminology_section"></a><a class="link" href="#_terminology_section">Terminology Section</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a><a class="link" href="#_overview">Overview</a></h3>
<div class="paragraph">
<p>This section describes the syntax of the <code>terminology</code> section of an archetype. The following section, <a href="#Terminology Integration">[Terminology Integration]</a> describes the semantics.</p>
</div>
<div class="paragraph">
<p>The <code>terminology</code> section of an archetype is expressed in ODIN, and is where codes representing node identifiers, constraints on coded term values, and bindings to terminologies are defined. Linguistic language translations are added in the form of extra blocks keyed by the relevant language. The following example shows the general layout of this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">terminology
    term_definitions = &lt;
        ["en"] = &lt;
            ["id1"] = &lt;...&gt;
            ["at1"] = &lt;...&gt;
            ["ac1"] = &lt;...&gt;
        &gt;
        ["de"] = &lt;
            ["id1"] = &lt;...&gt;
            ["at1"] = &lt;...&gt;
            ["ac1"] = &lt;...&gt;
        &gt;
    &gt;
    value_sets = &lt;
        ["ac1"] = &lt;
            id = &lt;"ac1"&gt;
            members = &lt;"at1", "at2", "at3", ...&gt;
        &gt;
    &gt;
    term_bindings = &lt;
        ["snomed_ct"] = &lt;
            ["id4"] = &lt;...&gt;
            ["ac1"] = &lt;...&gt;
            ...
        &gt;
    &gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_term_definitions_sub_section"><a class="anchor" href="#_term_definitions_sub_section"></a><a class="link" href="#_term_definitions_sub_section">Term_definitions Sub-section</a></h3>
<div class="paragraph">
<p>The <code>term_definitions</code> section is mandatory, and must contain definitions for all terms requiring them, in all translations in use in the archetype. Terms requiring definitions include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all id-codes of object nodes under a container attribute or which are multiple alternative siblings under a single-valued attribute</p>
</li>
<li>
<p>all at-codes</p>
</li>
<li>
<p>all ac-codes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example shows an extract from the English and German term definitions for the archetype local terms in a problem/SOAP headings archetype. Each term is defined using a structure of name/value pairs, and must at least include the names "text" and "description", which correspond to the usual rubric and full definition found in terminologies like <a href="http://www.snomed.org">SNOMED CT</a>. Each term object is then included in the appropriate language list of term definitions, as shown in the example below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    term_definitions = &lt;
        ["en"] = &lt;
            ["id1"] = &lt;
                text = &lt;"problem"&gt;
                description = &lt;"The problem experienced by the subject of care to which the contained information relates"&gt;
            &gt;
            ["id2"] = &lt;
                text = &lt;"problem/SOAP headings"&gt;
                description = &lt;"SOAP heading structure for multiple problems"&gt;
            &gt;
            ...
            ["id3"] = &lt;
                text = &lt;"plan"&gt;
                description = &lt;"The clinician's professional advice"&gt;
            &gt;
        &gt;
        ["de"] = &lt;
            ["id1"] = &lt;
                    text = &lt;"klinisches Problem"&gt;
                    description = &lt;"Das Problem des Patienten worauf sich diese Informationen beziehen"&gt;
            &gt;
            ["id2"] = &lt;
                    text = &lt;"Problem/SOAP Schema"&gt;
                    description = &lt;"SOAP-Schlagwort-Gruppierungsschema fuer mehrfache Probleme"&gt;
            &gt;
            ["id3"] = &lt;
                    text = &lt;"Plan"&gt;
                    description = &lt;"Klinisch-professionelle Beratung des Pflegenden"&gt;
            &gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In some cases, term definitions may have been lifted from existing terminologies (only a safe thing to do if the definitions <em>exactly</em> match the need in the archetype). To indicate where definitions come from, a "provenance" tag can be used, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    term_definitions = &lt;
        ["en"] = &lt;
            ...
            ["id3"] = &lt;
                text = &lt;"plan"&gt;
                description = &lt;"The clinician's professional advice"&gt;
                provenance = &lt;"ACME_terminology(v3.9a)"&gt;
            &gt;
            ...
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this does not indicate a <em>binding</em> to any term, only the origin of its definition. Bindings are described below.</p>
</div>
<div class="paragraph">
<p>The <code>term_definitions</code> section also includes definitions for archetype-local constraint codes, which are of the form <code>[acN]</code> in the <code>definition</code> part of an archetype. Each such code refers to a terminology 'value set', i.e. a set of possible terms that could be used as the value of the data item being constrained. These constraints are defined in two parts. First, the <code>ac</code> code itself is defined - this names the value set. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    --- within a specialist diagnosis archetype
    term_definitions = &lt;
        ["en"] = &lt;
            ...
            ["ac1"] = &lt;
                text = &lt;"type of hepatitis"&gt;
                description = &lt;"any term which means a kind of viral hepatitis"&gt;
            &gt;
            ...
        &gt;
    &gt;

    --- within a blood pressure measurement archetype
    term_definitions = &lt;
        ["en"] = &lt;
            ...
            ["ac3"] = &lt;
                text = &lt;"patient position"&gt;
                description = &lt;"patient position for blood pressure measurement"&gt;
            &gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_value_sets_sub_section"><a class="anchor" href="#_value_sets_sub_section"></a><a class="link" href="#_value_sets_sub_section">Value_sets Sub-section</a></h3>
<div class="paragraph">
<p>The second part is the value set contents. This can be defined either as an 'internal' value set consisting of at-codes, or else as being a value set defined in an external terminology and referenced via a binding. An internal value set is defined using an entry in the <code>value_sets</code> sub-section for the <code>ac</code> code, containing a list of at-code member values. Each of those members must have its own definition in the <code>term_definitions</code> section. The following shows the structures required.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">terminology
    term_definitions = &lt;
        ["en"] = &lt;
            ["ac1"] = &lt;...&gt;
            ["at1"] = &lt;...&gt;
            ["at2"] = &lt;...&gt;
            ["at3"] = &lt;...&gt;
        &gt;
    &gt;
    value_sets = &lt;
        ["ac1"] = &lt;
            id = &lt;"ac1"&gt;
            members = &lt;"at1", "at2", "at3", ...&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_term_bindings_sub_section"><a class="anchor" href="#_term_bindings_sub_section"></a><a class="link" href="#_term_bindings_sub_section">Term_bindings Sub-section</a></h3>
<div class="paragraph">
<p>A value set and/or its constituent terms may also have 'bindings' to externally defined terms and values sets. Object node id-codes may also have bindings, establishing external codings for the names of elements in an archetype. Binding is achieved in the <code>term_bindings</code> sub-section. Bindings are grouped under the target terminology they relate to, and each one consists of a key and a target. There are variations of each.</p>
</div>
<div class="paragraph">
<p>Keys can be any one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for id-coded object nodes:</p>
<div class="ulist">
<ul>
<li>
<p>just the id-code, e.g. <code>id4</code>;</p>
</li>
<li>
<p>an object node  absolute path terminating in an id-code, e.g. <code>"/data[id2]/events[id3]/data[id1]/item[id4]"</code>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>an at-code;</p>
</li>
<li>
<p>an ac-code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Binding targets are expressed as URIs that follow the model for terminology URIs published by IHTSDO <a href="#IHTSDO_URIs">[IHTSDO_URIs]</a> or a similar model, in the case of terminologies other than <a href="http://www.snomed.org">SNOMED CT</a>. Because URIs are native types in ADL/ODIN, they do not need quotes.</p>
</div>
<div class="paragraph">
<p>Bindings may be defined for a given set of terms for more than one terminology, enabling the different bindings to be used in different contexts, e.g. hospital deployment versus aged care.</p>
</div>
<div class="paragraph">
<p>The following is an extract from a <a href="https://github.com/openEHR/adl-archetypes/blob/master/ADL2-reference/features/terminology/term_bindings/openEHR-EHR-OBSERVATION.term_bindings_paths_use_refs.v1.adls">test archetype</a> based on the openEHR Apgar archetype, showing the different types of bindings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    --
    -- Derived from openEHR-EHR-OBSERVATION.term_bindings_paths_use_refs.v1.adls
    --
    term_definitions = &lt;
        ["en"] = &lt;
            ["id1"] = &lt;
                text = &lt;"Apgar score"&gt;
                description = &lt;"Clinical score derived from assessment of respiratory effort, heart rate, reflex irritability, muscle tone and skin colour."&gt;
            &gt;
            ["id4"] = &lt;
                text = &lt;"1 minute"&gt;
                description = &lt;"Apgar score 1 minute after birth."&gt;
            &gt;
            ["id6"] = &lt;
                text = &lt;"Heart Rate"&gt;
                description = &lt;"Recording of the infant's heart rate."&gt;
            &gt;
            ["id26"] = &lt;
                text = &lt;"Total"&gt;
                description = &lt;"The sum of the 5 ordinal scores for each component parameter."&gt;
            &gt;
            ...
            ["at7"] = &lt;
                text = &lt;"Absent"&gt;
                description = &lt;"No heart beat is seen, felt or heard."&gt;
            &gt;
            ...
        &gt;
    &gt;

    term_bindings = &lt;
        ["snomed_ct"] = &lt;
            ["/data[id3]/events[id4]/data[id2]/items[id26]"] = &lt;http://snomedct.info/id/169895004&gt; -- Apgar score at 1 minute
            ["id26"] = &lt;http://snomedct.info/id/249228009&gt; -- Total Apgar score (observable entity)
        &gt;
        ["loinc"] = &lt;
            ["/data[id3]/events[id4]"] = &lt;http://loinc.org/id/48334-7&gt;   -- 1-minute Apgar panel
            ["/data[id3]/events[id4]/data[id2]/items[id6]"] = &lt;http://loinc.org/id/32407-9&gt; -- 1 minute Apgar Heart rate
            ["at7"] = &lt;http://loinc.org/id/LA6716-0&gt;  -- No heart rate
            ...
        &gt;
        ["umls"] = &lt;
            ["id1"] = &lt;http://umls.nlm.edu/id/C124305&gt; -- apgar result
            ["id6"] = &lt;http://umls.nlm.edu/id/C234305&gt; -- cardiac score
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The reason for code and path keys for id-codes is to enable two types of id-code bindings. A binding to a simple code such as <code>id26|Total|</code>, above, means that the bound term (referred to by the URI <code><a href="http://snomedct.info/id/249228009" class="bare">http://snomedct.info/id/249228009</a></code>) has a context-independent correlation to the id-code. However, a 'pre-coordinated' code such as <a href="http://www.snomed.org">SNOMED CT</a> <code>169895004|Apgar score at 1 minute|</code> cannot be bound just to <code>id26|Total|</code>, but rather to the node representing the 1-minute total, i.e. at the path <code>/data[id3]/events[id4|1 minute|]/data[id2]/items[id26]</code>. Such paths can be considered as equivalent to a 'post-coordinated' code, and thus the binding establishes a correspondence between an internal post-coordination and an external pre-coordinated code.</p>
</div>
<div class="paragraph">
<p>In the example shown below, the <code>id4</code> code identifies a 'temperature' node in an archetype, and the codes <code>id3</code>, <code>id5</code>, <code>id6</code> etc correspond to various times such as 'any', '1-hour average', '1-hour maximum' and so on. Some terminologies (notably <a href="http://loinc.org">LOINC</a>, the laboratory terminology in this example) define pre-coordinated codes, such as '1 hour body temperature'; these clearly correspond not to single codes such as <code>id4</code> in the archetype, but to whole paths.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    term_bindings = &lt;
        ["LNC205"] = &lt;   -- LNC205 is a namespace corresponding to LOINC 205
            ["/data[id2]/events[id3]/data[id1]/item[id4]"] = &lt;http://loinc.org/id/8310-5&gt;
            ["/data[id2]/events[id5]/data[id1]/item[id4]"] = &lt;http://loinc.org/id/8321-2&gt;
            ["/data[id2]/events[id6]/data[id1]/item[id4]"] = &lt;http://loinc.org/id/8311-3&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Bindings to external value sets are also included in the bindings section, also as URIs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    term_bindings = &lt;
        ["snomed_ct"]    = &lt;
            ["ac1"] = &lt;http://snomed.info/id/123456789&gt;
            ["ac2"] = &lt;http://snomed.info/id/987654321&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, each local constraint code is formally defined to refer to a value set whose identifier is known in the <a href="http://www.snomed.org">SNOMED CT</a> terminology.</p>
</div>
<div class="paragraph">
<p>The next section describes the semantics of term constraining, value sets and binding in some detail.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deprecated_terminology_section_features"><a class="anchor" href="#_deprecated_terminology_section_features"></a><a class="link" href="#_deprecated_terminology_section_features">Deprecated Terminology Section Features</a></h3>
<div class="sect3">
<h4 id="_at_codes_as_identifiers"><a class="anchor" href="#_at_codes_as_identifiers"></a><a class="link" href="#_at_codes_as_identifiers">At-codes as identifiers</a></h4>
<div class="paragraph">
<p>In ADL 2, at-codes are used only as code values, not node identifiers. Id-codes are used for the latter purpose. This provides a clear separation between node 'names' and node 'values', for the kind of nodes whose values are coded terms.</p>
</div>
</div>
<div class="sect3">
<h4 id="_terminologies_avalable_sub_section"><a class="anchor" href="#_terminologies_avalable_sub_section"></a><a class="link" href="#_terminologies_avalable_sub_section">Terminologies_avalable sub-section</a></h4>
<div class="paragraph">
<p>In ADL 1.4, a <code>terminologies_available</code> header statement was required to identify all terminologies for which <code>term_bindings</code> sections have been written. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    terminologies_available = &lt;"snomed_ct", "loinc"&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This is no longer required. In archetypes that have it, it is ignored, and should not be included in ADL 2 or later syntax output serialisation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_separated_defnitions_and_bindings_sub_sections"><a class="anchor" href="#_separated_defnitions_and_bindings_sub_sections"></a><a class="link" href="#_separated_defnitions_and_bindings_sub_sections">Separated defnitions and bindings sub-sections</a></h4>
<div class="paragraph">
<p>In ADL 1.4, there were two separate definitions sections, <code>term_definitions</code> and <code>constraint_definitions</code>, used to defined <code>at</code> and <code>ac</code> codes respectively. In ADL 2, these are merged into one <code>term_definitions</code> section, containing the definitions for <code>id</code>, <code>at</code> and <code>ac</code> codes. Similarly there were bindings sections, <code>term_bindings ` and `constraint_bindings</code>. These have been merged into one <code>term_bindings</code> section.</p>
</div>
</div>
<div class="sect3">
<h4 id="_term_definitions_structure"><a class="anchor" href="#_term_definitions_structure"></a><a class="link" href="#_term_definitions_structure">Term_definitions Structure</a></h4>
<div class="paragraph">
<p>The following shows the structure of the terminology section used in ADL 1.4 archetypes. The extra <code>items</code> attribute notes are removed by ADL 2 tools, and should be considered deprecated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    term_definitions = &lt;
        ["en"] = &lt;
            items = &lt;
                ["at0001"] = &lt;...&gt;
                ["at0002"] = &lt;...&gt;
            &gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_annotations_section"><a class="anchor" href="#_annotations_section"></a><a class="link" href="#_annotations_section">Annotations Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>annotations</code> section of an archetype or template provides a place for ad hoc node-level meta-data to be added. This can be used during the design phase to track dependencies, design decisions, and specific resource references.</p>
</div>
<div class="paragraph">
<p>Annotations are divided into major named groups. Currently a <code>documentation</code> group is defined, intended for documentary (i.e. human-readable text) annotations. Other groups are likely to be defined in the future for various kinds of processing, where the annotations may be formal expressions or code fragments.</p>
</div>
<div class="paragraph">
<p>Each annotation is keyed by a path, and may have any number of tagged elements. The path key can either be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the path of the archetype node being annotated, or</p>
</li>
<li>
<p>a pure RM path</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The usual case is the first, since annotations mainly relate to nodes in an archetype. However, it may be the case that within the context of the archetype, there is a need to refer to a part of the Reference Model type on which the archetype is based (<code>OBSERVATION</code>, <code>EVALUATION</code> etc) that <em>is not</em> constrained within the archetype, in order to indicate how it is to be understood within that archetyped structure (remember that an archetype does not need to constrain all possible paths of an information model class, but that such structures may nevertheless be instantiated).</p>
</div>
<div class="paragraph">
<p>A typical <code>annotations</code> section looks as follows (<a href="https://github.com/openEHR/adl-archetypes/blob/master/ADL2-reference/features/description/annotations/openEHR-EHR-EVALUATION.annotations_1st_child.v1.adls">archetype source</a>). The <code>/subject</code> path is a non-constrained 'RM path'.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">--
-- Extract from test archetype openEHR-EHR-EVALUATION.annotations_1st_child.v1.0.0
--
definition
    EVALUATION[id1.1] matches {    -- Exclusion statement - Adverse Reaction
        /data[id2]/items matches {
            ...
            ELEMENT[id0.8] occurrences matches {0..1} matches {    -- No known allergic reaction to
                value matches {
                    DV_TEXT[id0.6]
                }
            }
            ...
            ELEMENT[id0.10] occurrences matches {0..1} matches {    -- No known intolerance to
                value matches {
                    DV_TEXT[id0.8]     -- No known allergic reaction to
                }
            }
        }
    }

terminology
    ...

annotations
    documentation = &lt;
        ["en"] = &lt;
            ["/subject"] = &lt;
                ["design note"] = &lt;"xxxxxx"&gt;
            &gt;
            ["/data[id2]/items[id0.8]"] = &lt;
                ["design note"] = &lt;"this is a design note on allergic reaction"&gt;
                ["requirements note"] = &lt;"this is a requirements note on allergic reaction"&gt;
                ["medline ref"] = &lt;"this is a medline ref on allergic reaction"&gt;
            &gt;
            ["/data[id2]/items[id0.10]"] = &lt;
                ["design note"] = &lt;"this is a design note on intelerance"&gt;
                ["requirements note"] = &lt;"this is a requirements note on intolerance"&gt;
                ["national data dictionary"] = &lt;"NDD ref for intolerance"&gt;
            &gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because annotations are defined as a separate section, they can be easily removed in production versions of an archetype or template, and ignored in the generation of digital signatures.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../default_values/">Default Values</a></span>
  <span class="next"><a href="../terminology_integration/">Terminology Integration</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>
    Copyright: 짤 2003+
    <a href="https://www.openehr.org"
        alt="is an independent, non-profit foundation, facilitating the sharing of health
           records by consumers and clinicians via open specifications, clinical models
           and open platform implementations.">The openEHR Foundation</a>
  </p>

  <p>
    License:
    <img src="/_/img/cc-by-nd-88x31.png"
        alt="Creative Commons Attribution-NoDerivs 3.0 Unported."
        style="vertical-align:middle;margin:0 0.25rem 0 0;">
    <a href="https://creativecommons.org/licenses/by-nd/3.0/">
      Creative Commons Attribution-NoDerivs 3.0 Unported.
    </a>
  </p>

  <p>
    <strong>Links: <strong>
    <a href="https://www.openehr.org/terms-of-use" class="mr-1">Terms of use</a> |
    <a href="https://www.openehr.org/privacy-policy" class="mx-1">Privacy policy</a> |
    <a href="https://www.openehr.org/privacy-policy" class="mx-1">Logos &amp; Trademarks</a> |
    <a href="https://www.openehr.org/contact-us" class="mx-1">Contact</a>
  </p>
</footer>

<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="80" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
<script src="../../../../_/js/medium-zoom.min.js"></script>
<script src="../../../../_/js/zoom.js"></script>
  </body>
</html>
