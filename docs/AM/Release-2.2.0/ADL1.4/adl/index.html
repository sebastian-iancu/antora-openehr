<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>ADL - Archetype Definition Language :: openEHR Specifications (Local Build)</title>
    <link rel="canonical" href="https://sebastian-iancu.github.io/antora-openehr/AM/latest/ADL1.4/adl/">
    <link rel="prev" href="../paths/">
    <link rel="next" href="../customising_adl/">
    <meta name="description" content="openEHR Archetype Definition Language 1.4 (ADL1.4) (ISO 13606-2:2008)">
    <meta name="keywords" content="EHR, ADL, AOM, health records, archetypes, constraint language, ISO 13606, openehr">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../../../ui/css/site.css">
    <link rel="stylesheet" href="../../../../ui/css/antora-openehr.css">
    <link rel="stylesheet" href="../../../../ui/css/openehr.css">
<link rel="icon" href="../../../../ui/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://sebastian-iancu.github.io/antora-openehr">openEHR Specifications (Local Build)</a>

      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field has-filter">
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:AM"> Archetype Model only
          </label>
        </div>
      </div>

      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Specifications</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://specifications.openehr.org/" target="_blank">
              openEHR specification
            </a>
            <a class="navbar-item" href="https://specifications.openehr.org/releases/UML/development/index.html" target="_blank">
              openEHR portal
            </a>
            <a class="navbar-item" href="https://ckm.openehr.org/ckm/" target="_blank">
              openEHR CKM
            </a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://openehr.atlassian.net/secure/Dashboard.jspa?selectPageId=10190" target="_blank">
              Issue trackers
            </a>
            <a class="navbar-item" href="https://discourse.openehr.org/" target="_blank">
              Discourse Forum
            </a>
            <a class="navbar-item" href="https://specifications.openehr.org/wiki/display/spec/Specifications+Home" target="_blank">
              Wiki
            </a>
            <a class="navbar-item" href="https://github.com/openEHR" target="_blank">
              GitHub
            </a>
          </div>
        </div>

      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="AM" data-version="Release-2.2.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../">Archetype Model</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../">Archetype Definition Language 1.4 (ADL1.4)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../file_encoding/">File Encoding and Character Quoting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../dadl/">dADL - Data ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../cadl/">cADL - Constraint ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../assertions/">Assertions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../paths/">ADL Paths</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="./">ADL - Archetype Definition Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../customising_adl/">Customising ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../other_formalisms/">Relationship of ADL to Other Formalisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../extended_metadata/">Extended Meta-data Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax_spec/">Syntax Specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../ADL2/">Archetype Definition Language 2 (ADL2)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/file_encoding/">File Encoding and Character Quoting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/cadl/">cADL - Constraint ADL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/paths/">ADL Paths</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/default_values/">Default Values</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/adl/">ADL - Archetype Definition Language</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/terminology_integration/">Terminology Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/specialisation/">Specialisation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/templates/">Templates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/other_formalisms/">Relationship of ADL to Other Formalisms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/syntax_spec/">Syntax Specification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../ADL2/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../AOM1.4/">Archetype Object Model 1.4 (AOM1.4)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/model_overview/">The Archetype Object Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/archetype_package/">The Archetype Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/constraint_model_package/">Constraint Model Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/assertion_package/">The Assertion Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/primitive_package/">Primitive Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/ontology_package/">Terminology Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/domain_extension/">Domain-specific Extension Example</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/diverse_reference_models/">Using Archetypes with Diverse Reference Models</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/rm_dependencies/">Reference Model Dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM1.4/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../AOM2/">Archetype Object Model 2 (AOM2)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/model_overview/">Model Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/archetype_package/">The Archetype Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/constraint_model_package/">Constraint Model Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/rules_package/">The Rules Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/rm_overlay/">The RM Overlay Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/terminology_package/">Terminology Package</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/validation/">Validation and Transformation Semantics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/serialisation_model/">Serialisation Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/templates/">Templates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/rm_adaptation/">Reference Model Adaptation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../AOM2/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../Identification/">Archetype Identification</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/artefact_source_id/">Source Artefact Identification</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/versioning/">Versioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/lifecycle_mgt/">Lifecycle Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/distributed_governance/">Distributed Governance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/referencing/">Referencing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/uris/">A Reliable URI for Knowledge Resources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/artefact_authentication/">Artefact Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/scenarios/">Scenarios</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Identification/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#index.adoc">Language Design</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../OPT2/">Operational Template 2 (OPT2)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/preface/">Preface</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/overview/">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/opt_raw/">The Raw Operational Template</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/opt_profiled/">The Profiled Operational Template</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/file_formats/">File Formats</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../OPT2/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../Overview/">Archetype Technology Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/introduction/">Business Purpose of Archetypes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/formalism_overview/">Archetype Formalism Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/the_specifications/">The Specifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/semantic_overview/">Semantic Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/artefacts/">Artefacts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../Overview/amendment_record/">Amendment Record</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Archetype Model</span>
    <span class="version">Release-2.2.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../../../latest/">Archetype Model</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../latest/">Release-2.3.0</a>
        </li>
        <li class="version is-current">
          <a href="../../">Release-2.2.0</a>
        </li>
        <li class="version">
          <a href="../../../development/">development</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../BASE/latest/">Base Model</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../BASE/latest/">Release-1.2.0</a>
        </li>
        <li class="version">
          <a href="../../../../BASE/Release-1.1.0/">Release-1.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../BASE/development/">development</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../RM/latest/">Reference Model</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../RM/latest/">Release-1.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../RM/Release-1.0.4/">Release-1.0.4</a>
        </li>
        <li class="version">
          <a href="../../../../RM/development/">development</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../BASE/latest/" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../">Archetype Model</a></li>
    <li><a href="../">Archetype Definition Language 1.4 (ADL1.4)</a></li>
    <li><a href="./">ADL - Archetype Definition Language</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">Release-2.2.0</button>
  <div class="version-menu">
    <a class="version" href="../../../latest/ADL1.4/adl/">Release-2.3.0</a>
    <a class="version is-current" href="./">Release-2.2.0</a>
    <a class="version" href="../../../development/ADL1.4/adl/">development</a>
  </div>
</div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">ADL - Archetype Definition Language</h1>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a><a class="link" href="#_introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes ADL archetypes as a whole, adding a small amount of detail to the descriptions of dADL and cADL already given. The important topic of the relationship of the cADL-encoded definition section and the dADL-encoded ontology section is discussed in detail. In this section, only standard ADL (i.e. the cADL and dADL constructs and types described so far) is assumed. Archetypes for use in particular domains can also be built with more efficient syntax and domain-specific types, as described in <a href="#Customising ADL">[Customising ADL]</a>, and the succeeding sections.</p>
</div>
<div class="paragraph">
<p>An ADL archetype follows the structure shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>archetype
    archetype_id
[specialize
    parent_archetype_id]
concept
    coded_concept_name
language
    dADL language description section
[description
    dADL meta-data description section]
definition
    cADL structural section
invariant
    assertions
ontology
    dADL definitions section
[revision_history
    dADL section]</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basics"><a class="anchor" href="#_basics"></a><a class="link" href="#_basics">Basics</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_keywords"><a class="anchor" href="#_keywords"></a><a class="link" href="#_keywords">Keywords</a></h3>
<div class="paragraph">
<p>ADL has a small number of keywords which are reserved for use in archetype declarations, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>archetype</code>, <code>specialise</code> / <code>specialize</code>, <code>concept</code>,</p>
</li>
<li>
<p><code>language</code> ,</p>
</li>
<li>
<p><code>description</code> , <code>definition</code> , <code>invariant</code> , <code>ontology</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of these words can safely appear as identifiers in the <code>definition</code> and <code>ontology</code> sections.</p>
</div>
</div>
<div class="sect2">
<h3 id="_node_identification"><a class="anchor" href="#_node_identification"></a><a class="link" href="#_node_identification">Node Identification</a></h3>
<div class="paragraph">
<p>In the definition section of an ADL archetype, a particular scheme of codes is used for node identifiers as well as for denoting constraints on textual (i.e. language dependent) items. Codes are either local to the archetype, or from an external lexicon. This means that the archetype description is the same in all languages, and is available in any language that the codes have been translated to. All term codes are shown in brackets (<code>[]</code>). Codes used as node identifiers and defined within the same archetype are prefixed with <code>at</code> and by convention have 4 digits, e.g. <code>[at0010]</code>. Codes of any length are acceptable in ADL archetypes. Specialisations of locally coded concepts have the same root, followed by 'dot' extensions, e.g. <code>[at0010.2]</code>. From a terminology point of view, these codes have no implied semantics - the 'dot' structuring is used as an optimisation on node identification.</p>
</div>
</div>
<div class="sect2">
<h3 id="_local_constraint_codes"><a class="anchor" href="#_local_constraint_codes"></a><a class="link" href="#_local_constraint_codes">Local Constraint Codes</a></h3>
<div class="paragraph">
<p>A second kind of local code is used to stand for constraints on textual items in the body of the archetype. Although these could be included in the main archetype body, because they are language- and/or terminology-sensitive, they are defined in the ontology section, and referenced by codes prefixed by <code>ac</code>, e.g. <code>[ac0009]</code>. As for <code>at</code> codes, the convention used in this document is to use 4-digit <code>ac</code> codes, even though any number of digits is acceptable. The use of these codes is described in section
<a href="#Constraint_definitions section">[Constraint_definitions section]</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_header_sections"><a class="anchor" href="#_header_sections"></a><a class="link" href="#_header_sections">Header Sections</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_archetype_section"><a class="anchor" href="#_archetype_section"></a><a class="link" href="#_archetype_section">Archetype Section</a></h3>
<div class="paragraph">
<p>This section introduces the archetype and must include an identifier. A typical archetype section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=1.4)
    openEHR-EHR-OBSERVATION.haematology.v1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The multi-axial identifier identifies archetypes in a global space. The syntax of the identifier is described in <a href="#Archetype Identification">[Archetype Identification]</a> in <a href="https://specifications.openehr.org/releases/1.0.2/architecture/am/archetype_system.pdf">The openEHR Archetype System</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_controlled_indicator"><a class="anchor" href="#_controlled_indicator"></a><a class="link" href="#_controlled_indicator">Controlled Indicator</a></h3>
<div class="paragraph">
<p>A flag indicating whether the archetype is change-controlled or not can be included after the version, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=1.4; controlled)
    openEHR-EHR-OBSERVATION.haematology.v1</code></pre>
</div>
</div>
<div class="paragraph">
<p>This flag may have the two values "controlled" and "uncontrolled" only, and is an aid to software. Archetypes that include the "controlled" flag should have the revision history section included, while those with the "uncontrolled" flag, or no flag at all, may omit the revision history. This enables archetypes to be privately edited in an early development phase without generating large revision histories of little or no value.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specialise_section"><a class="anchor" href="#_specialise_section"></a><a class="link" href="#_specialise_section">Specialise Section</a></h3>
<div class="paragraph">
<p>This optional section indicates that the archetype is a specialisation of some other archetype, whose identity must be given. Only one specialisation parent is allowed, i.e. an archetype cannot 'multiply-inherit' from other archetypes. An example of declaring specialisation is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">archetype (adl_version=1.4)
    openEHR-EHR-OBSERVATION.haematology-cbc.v1
specialise
    openEHR-EHR-OBSERVATION.haematology.v1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the identifier of the new archetype is derived from that of the parent by adding a new section to its domain concept section. See the <code>ARCHETYPE_ID</code> definition in the identification package in the <a href="https://specifications.openehr.org/releases/RM/latest/support.html">openEHR Support IM specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
both the US and British English versions of the word "specialise" are valid in ADL.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_concept_section"><a class="anchor" href="#_concept_section"></a><a class="link" href="#_concept_section">Concept Section</a></h3>
<div class="paragraph">
<p>All archetypes represent some real world concept, such as a "patient", a "blood pressure", or an "antenatal examination". The concept is always coded, ensuring that it can be displayed in any language the archetype has been translated to. A typical concept section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>concept
    [at0010] -- haematology result</pre>
</div>
</div>
<div class="paragraph">
<p>In this concept definition, the term definition of <code>[at0010]</code> is the proper description corresponding to the "haematology-cbc" section of the archetype id above.</p>
</div>
</div>
<div class="sect2">
<h3 id="_language_section_and_language_translation"><a class="anchor" href="#_language_section_and_language_translation"></a><a class="link" href="#_language_section_and_language_translation">Language Section and Language Translation</a></h3>
<div class="paragraph">
<p>The <code>language</code> section includes data describing the original language in which the archetype was authored (essential for evaluating natural language quality), and the total list of languages available in the archetype. There can be only one <code>original_language</code>. The <code>translations</code> list must be updated every time a translation of the archetype is undertaken. The following shows a typical example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">language
    original_language = &lt;[iso_639-1::en]&gt;
    translations = &lt;
        ["de"] = &lt;
            language = &lt;[iso_639-1::de]&gt;
            author = &lt;
                ["name"] = &lt;"Frederik Tyler"&gt;
                ["email"] = &lt;"freddy@something.somewhere.co.uk"&gt;
            &gt;
            accreditation = &lt;"British Medical Translator id 00400595"&gt;
        &gt;
        ["ru"] = &lt;
            language = &lt;[iso_639-1::ru]&gt;
            author = &lt;
                ["name"] = &lt;"Nina Alexandrovna"&gt;
                ["organisation"] = &lt;"Dostoevsky Media Services"&gt;
                ["email"] = &lt;"nina@translation.dms.ru"&gt;
            &gt;
            accreditation = &lt;"Russian Translator id 892230-3A"&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Archetypes must always be translated completely, or not at all, to be valid. This means that when a new translation is made, every language dependent section of the <code>description</code> and <code>ontology</code> sections has to be translated into the new language, and an appropriate addition made to the <code>translations</code> list in the language section.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
some non-conforming ADL tools in the past created archetypes without a <code>language</code> section, relying on the <code>ontology</code> section to provide the <code>original_language</code> (there called <code>primary_language</code>) and list of languages (<code>languages_available</code>). In the interests of backward compatibility, tool builders should consider accepting archetypes of the old form and upgrading them when parsing to the correct form, which should then be used for serialising/saving.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_description_section"><a class="anchor" href="#_description_section"></a><a class="link" href="#_description_section">Description Section</a></h3>
<div class="paragraph">
<p>The <code>description</code> section of an archetype contains descriptive information, or what some people think of as document "meta-data", i.e. items that can be used in repository indexes and for searching. The dADL syntax, described in <a href="#dADL - Data ADL">[dADL - Data ADL]</a>, is used for the description, as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">description
    original_author = &lt;
        ["name"] = &lt;"Dr J Joyce"&gt;
        ["organisation"] = &lt;"NT Health Service"&gt;
        ["date"] = &lt;2003-08-03&gt;
    &gt;
    lifecycle_state =  &lt;"initial"&gt;
    resource_package_uri =  &lt;"http://www.aihw.org.au/data_sets/diabetic_archetypes.html"&gt;

    details = &lt;
        ["en"] = &lt;
            language = &lt;[iso_639-1::en]&gt;
            purpose =  &lt;"archetype for diabetic patient review"&gt;
            use = &lt;"used for all hospital or clinic-based diabetic reviews,
                including first time. Optional sections are removed according to the particular review"&gt;
            misuse = &lt;"not appropriate for pre-diagnosis use"&gt;
            original_resource_uri = &lt;"http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html"&gt;
            other_details = &lt;...&gt;
        &gt;
        ["de"] = &lt;
            language = &lt;[iso_639-1::de]&gt;
            purpose =  &lt;"Archetyp für die Untersuchung von Patienten mit Diabetes"&gt;
            use = &lt;"wird benutzt für alle Diabetes-Untersuchungen im
                    Krankenhaus, inklusive der ersten Vorstellung. Optionale
                    Abschnitte werden in Abhängigkeit von der speziellen
                    Vorstellung entfernt."&gt;
            misuse = &lt;"nicht geeignet für Benutzung vor Diagnosestellung"&gt;
            original_resource_uri = &lt;"http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html"&gt;
            other_details = &lt;...&gt;
        &gt;
    &gt;

    other_details = &lt;...&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A number of details are worth noting here. Firstly, the free hierarchical structuring capability of dADL is exploited for expressing the 'deep' structure of the <code>details</code> section and its subsections. Secondly, the dADL qualified list form is used to allow multiple translations of the <code>purpose</code> and <code>use</code> to be shown. Lastly, empty items such as <code>misuse</code> (structured if there is data) are shown with just one level of empty brackets. The above example shows meta-data based on the <a href="https://specifications.openehr.org/releases/AM/latest/AOM1.4.html">openEHR Archetype Object Model (AOM)</a>.</p>
</div>
<div class="paragraph">
<p>The <code>description</code> section is technically optional according to the AOM, but in any realistic use of ADL for archetypes, it will be required. A minimal description section satisfying to the AOM is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">description
    original_author = &lt;
        ["name"] = &lt;"Dr J Joyce"&gt;
        ["organisation"] = &lt;"NT Health Service"&gt;
        ["date"] = &lt;2003-08-03&gt;
    &gt;
    lifecycle_state = &lt;"initial"&gt;
    details = &lt;
        ["en"] = &lt;
            language = &lt;[iso_639-1::en]&gt;
            purpose = &lt;"archetype for diabetic patient review"&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_extending_meta_data"><a class="anchor" href="#_extending_meta_data"></a><a class="link" href="#_extending_meta_data">Extending meta-data</a></h4>
<div class="paragraph">
<p>The <code>description</code> section models a specific set of meta-data items, but of course, the meta-data needs over time can never be fully predicted. To enable free extension of the <code>description</code> section, the <code>other_details</code> is used. Its structure takes the form of a Hash of strings, i.e. <code>Hash &lt;String, String&gt;</code>, and can be used to contain other meta-data items not explicitly modelled.</p>
</div>
<div class="paragraph">
<p>The <a href="#Extended Meta-data Guide">[Extended Meta-data Guide]</a> Appendix describes the known uses of extended meta-data to date.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_definition_section"><a class="anchor" href="#_definition_section"></a><a class="link" href="#_definition_section">Definition Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>definition</code> section contains the main formal definition of the archetype, and is written in <a href="#cADL - Constraint ADL">the Constraint Definition Language</a>). A typical <code>definition</code> section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">definition
    OBSERVATION[at0000] ∈ {                                              -- blood pressure measurement
        name ∈ {                                                         -- any synonym of BP
            CODED_TEXT ∈ {
                defining_code ∈ {
                    CODE_PHRASE ∈ {[ac0001]}
                }
            }
        }
        data ∈ {
            HISTORY[at9001] ∈ {                                           -- history
                events cardinality ∈ {1..*} ∈ {
                    EVENT[at9002] occurrences ∈ {0..1} ∈ {               -- baseline
                        name ∈ {
                            CODED_TEXT ∈ {
                                defining_code ∈ {
                                    CODE_PHRASE ∈ {[ac0002]}
                                }
                            }
                        }
                        data ∈ {
                            ITEM_LIST[at1000] ∈ {                           -- systemic arterial BP
                                items cardinality ∈ {2..*} ∈ {
                                    ELEMENT[at1100] ∈ {                     -- systolic BP
                                        name ∈ {                            -- any synonym of 'systolic'
                                            CODED_TEXT ∈ {
                                                defining_code ∈ {
                                                    CODE_PHRASE ∈ {[ac0002]}
                                                }
                                            }
                                        }
                                        value ∈ {
                                            QUANTITY ∈ {
                                                magnitude ∈ {|0..1000|}
                                                property ∈ {[properties::944]}  -- "pressure"
                                                units ∈ {[units::387]}          -- "mm[Hg]"
                                            }
                                        }
                                    }
                                    ELEMENT[at1200] ∈ {                          -- diastolic BP
                                        name ∈ {                                 -- any synonym of 'diastolic'
                                            CODED_TEXT ∈ {
                                                defining_code ∈ {
                                                    CODE_PHRASE ∈ {[ac0003]}
                                                }
                                            }
                                        }
                                        value ∈ {
                                            QUANTITY ∈ {
                                                magnitude ∈ {|0..1000|}
                                                property ∈ {[properties::944]}   -- "pressure"
                                                units ∈ {[units::387]}           -- "mm[Hg]"
                                            }
                                        }
                                    }
                                    ELEMENT[at9000] occurrences ∈ {0..*} ∈ {*}    -- unknown new item
                                }
                            ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This definition expresses constraints on instances of the types <code>ENTRY</code> , <code>HISTORY</code> , <code>EVENT</code> , <code>ITEM_LIST</code> , <code>ELEMENT</code> , <code>QUANTITY</code> , and <code>CODED_TEXT</code> so as to allow them to represent a blood pressure measurement, consisting of a history of measurement events, each consisting of at least systolic and diastolic pressures, as well as any number of other items (expressed by the <code>[at9000]</code> "any" node near the bottom).</p>
</div>
<div class="sect2">
<h3 id="_design_time_and_run_time_paths"><a class="anchor" href="#_design_time_and_run_time_paths"></a><a class="link" href="#_design_time_and_run_time_paths">Design-time and Run-time paths</a></h3>
<div class="paragraph">
<p>All non-unique sibling nodes in a cADL text that correspond to nodes in data which might be referred to from elsewhere in the archetype (via <code>use_node</code>), or might be queryied at runtime, require a node identifier. It is preferable to assign a 'design-time meaning', enabling paths and queries to be expressed using logical meanings rather than meaningless identifiers. When data are created according to the <code>definition</code> section of an archetype, the archetype node identifiers can be written into the data, providing a reliable way of finding data nodes, regardless of what other runtime names might have been chosen by the user for the node in question. There are two reasons for doing this. Firstly, querying cannot rely on runtime names of nodes (e.g. names like "sys BP", "systolic bp", "sys blood press." entered by a doctor are unreliable for querying); secondly, it allows runtime data retrieved from a persistence mechanism to be re-associated with the cADL structure which was used to create it.</p>
</div>
<div class="paragraph">
<p>An example which shows the difference between design-time meanings associated with node identifiers and runtime names is the following, from a <code>SECTION</code> archetype representing the problem/SOAP headings (a simple heading structure commonly used by clinicians to record patient contacts under top-level headings corresponding to the patient&#8217;s problem(s), and under each problem heading, the headings "subjective", "objective", "assessment", and "plan").</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cadl" data-lang="cadl">    SECTION[at0000] matches {                          -- problem
        name matches {
            CODED_TEXT matches {
                defining_code matches {[ac0001]}       -- any clinical problem type
            }
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the node identifier <code>[at0000]</code> is assigned a meaning such as "clinical problem" in the archetype terminology section. The subsequent lines express a constraint on the runtime <em>name</em> attribute, using the internal code <code>[ac0001]</code> . The constraint <code>[ac0001]</code> is also defined in the archetype terminology section with a formal statement meaning "any clinical problem type", which could clearly evaluate to thousands of possible values, such as "diabetes", "arthritis" and so on. As a result, in the runtime data, the node identifier corresponding to "clinical problem" and the actual problem type chosen at runtime by a user, e.g. "diabetes", can both be found. This enables querying to find all nodes with meaning "problem", or all nodes describing the problem "diabetes". Internal <code>[acNNNN]</code> codes are described in <a href="#_local_constraint_codes">Local Constraint Codes</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_invariant_section"><a class="anchor" href="#_invariant_section"></a><a class="link" href="#_invariant_section">Invariant Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>rules</code> section in an ADL archetype introduces assertions which relate to the entire archetype, and can be used to make statements which are not possible within the block structure of the <code>definition</code> section. Any constraint which relates more than one property to another is in this category, as are most constraints containing mathematical or logical formulae. Rules are expressed in the archetype assertion language, described in <a href="#Assertions">[Assertions]</a>.</p>
</div>
<div class="paragraph">
<p>An assertion is a first order predicate logic statement which can be evaluated to a boolean result at runtime. Objects and properties are referred to using paths.</p>
</div>
<div class="paragraph">
<p>The following simple example says that the speed in kilometres of some node is related to the speed-in-miles by a factor of 1.6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">invariant
    validity: /speed[at0002]/kilometres/magnitude = /speed[at0004]/miles/magnitude * 1.6</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ontology_section"><a class="anchor" href="#_ontology_section"></a><a class="link" href="#_ontology_section">Ontology Section</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a><a class="link" href="#_overview">Overview</a></h3>
<div class="paragraph">
<p>The <code>ontology</code> section of an archetype is expressed in dADL, and is where codes representing node identifiers, constraints on coded term values, and bindings to terminologies are defined. Linguistic language translations are added in the form of extra blocks keyed by the relevant language. The following example shows the general layout of this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">ontology
    terminologies_available = &lt;"snomed_ct", ...&gt;

    term_definitions = &lt;
        ["en"] = &lt;
            items = &lt;...&gt;
        &gt;
        ["de"] = &lt;
            items = &lt;...&gt;
        &gt;
    &gt;
    constraint_definitions = &lt;
        ["en"] = &lt;
            items = &lt;...&gt;
        &gt;
        ["de"] = &lt;
            items = &lt;...&gt;
        &gt;
    &gt;
    term_bindings = &lt;
        ["snomed_ct"] = &lt;
            items = &lt;...&gt;
            ...
        &gt;
    &gt;
    constraint_bindings = &lt;
        ["snomed_ct"] = &lt;
            items = &lt;...&gt;
            ...
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>term_definitions</code> section is mandatory, and must be defined for each translation carried out. Each of these sections can have its own meta-data, which appears within description sub-sections, such as the one shown above providing translation details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ontology_header_statements"><a class="anchor" href="#_ontology_header_statements"></a><a class="link" href="#_ontology_header_statements">Ontology Header Statements</a></h3>
<div class="paragraph">
<p>The <code>terminologies_available</code> statement includes the identifiers of all terminologies for which <code>term_bindings</code> sections have been written.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
some ADL tools in the past created archetypes with <code>primary_language</code> and <code>languages_available</code> statements rather than the <code>original_languages</code> and <code>translations</code> blocks in the <code>language</code> section. In the interests of backward compatibility, tool builders should consider accepting archetypes of the old form and upgrading them when parsing to the correct form, which should then be used for serialising/saving.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_term_definitions_section"><a class="anchor" href="#_term_definitions_section"></a><a class="link" href="#_term_definitions_section">Term_definitions Section</a></h3>
<div class="paragraph">
<p>This section is where all archetype local terms (that is, terms of the form <code>[atNNNN]</code>) are defined. The following example shows an extract from the English and German term definitions for the archetype local terms in a problem/SOAP headings archetype. Each term is defined using a structure of name/value pairs, and mustat least include the names "text" and "description", which are akin to the usual rubric, and full definition found in terminologies like SNOMED-CT. Each term object is then included in the appropriate language list of term definitions, as shown in the example below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    term_definitions = &lt;
        ["en"] = &lt;
            items = &lt;
                ["at0000"] = &lt;
                    text = &lt;"problem"&gt;
                    description = &lt;"The problem experienced by the subject of care to which the contained information relates"&gt;
                &gt;
                ["at0001"] = &lt;
                    text = &lt;"problem/SOAP headings"&gt;
                    description = &lt;"SOAP heading structure for multiple problems"&gt;
                &gt;
                ...
                ["at4000"] = &lt;
                    text = &lt;"plan"&gt;
                    description = &lt;"The clinician's professional advice"&gt;
                &gt;
            &gt;
        &gt;
        ["de"] = &lt;
            items = &lt;
                ["at0000"] = &lt;
                    text = &lt;"klinisches Problem"&gt;
                    description = &lt;"Das Problem des Patienten worauf sich diese Informationen beziehen"&gt;
                &gt;
                ["at0001"] = &lt;
                    text = &lt;"Problem/SOAP Schema"&gt;
                    description = &lt;"SOAP-Schlagwort-Gruppierungsschema fuer mehrfache Probleme"&gt;
                &gt;
                ["at4000"] = &lt;
                    text = &lt;"Plan"&gt;
                    description = &lt;"Klinisch-professionelle Beratung des Pflegenden"&gt;
                &gt;
            &gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In some cases, term definitions may have been lifted from existing terminologies (only a safe thing to do if the definitions <em>exactly</em> match the need in the archetype). To indicate where definitions come from, a "provenance" tag can be used, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">    ["at4000"] = &lt;
        text = &lt;"plan"&gt;
        description = &lt;"The clinician's professional advice"&gt;
        provenance = &lt;"ACME_terminology(v3.9a)"&gt;
    &gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this does not indicate a <em>binding</em> to any term, only the origin of its definition. Bindings are described below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the use of <code>items</code> in the above is historical in ADL, and will be changed in ADL2 to the proper form of dADl for nested containers, i.e. removing the "items = &lt;" blocks altogether.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_constraint_definitions_section"><a class="anchor" href="#_constraint_definitions_section"></a><a class="link" href="#_constraint_definitions_section">Constraint_definitions Section</a></h3>
<div class="paragraph">
<p>The constraint_definitions section is of exactly the same form as the <code>term_definitions</code> section, and provides the definitions - i.e. the meanings - of the local constraint codes, which are of the form <code>[acNNNN]</code>. Each such code refers to some constraint such as "any term which is a subtype of 'hepatitis' in the ICD10AM terminology"; the constraint definitions do not provide the constraints themselves, but define the <em>meanings</em> of such constraints, in a manner comprehensible to human beings, and usable in GUI applications. This may seem a superfluous thing to do, but in fact it is quite important. Firstly, term constraints can only be expressed with respect to particular terminologies - a constraint for "kind of hepatitis" would be expressed in different ways for each terminology which the archetype is bound to. For this reason, the actual constraints are defined in the <code>constraint_bindings</code> section. An example of a constraint term definition for the hepatitis constraint is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">items = &lt;
    ["ac1015"] = &lt;
        text = &lt;"type of hepatitis"&gt;
        description = &lt;"any term which means a kind of viral hepatitis"&gt;
    &gt;
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that while it often seems tempting to use classification codes, e.g. from the <a href="http://www.who.int/classifications/icd/en/">ICD vocabularies</a>, these will rarely be much use in terminology or constraint definitions, because it is nearly always <em>descriptive</em>, not classificatory terms which are needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_term_bindings_section"><a class="anchor" href="#_term_bindings_section"></a><a class="link" href="#_term_bindings_section">Term_bindings Section</a></h3>
<div class="paragraph">
<p>This section is used to describe the equivalences between archetype local terms and terms found in external terminologies. The main purpose for allowing query engine software that wants to search for an instance of some external term to determine what equivalent to use in the archetype. Note that this is distinct from the process of embedding mapped terms in runtime data, which is also possible with the openEHR Reference Model <code>DV_TEXT</code> and <code>DV_CODED_TEXT</code> types.</p>
</div>
<div class="sect3">
<h4 id="_global_term_bindings"><a class="anchor" href="#_global_term_bindings"></a><a class="link" href="#_global_term_bindings">Global Term Bindings</a></h4>
<div class="paragraph">
<p>There are two types of term bindings that can be used, 'global' and path-based. The former is where an external term is bound directly to an archetype local term, and the binding holds globally throughout the archetype. In many cases, archetype terms only appear once in an archetype, but in some archetypes, at-codes are reused throughout the archetype. In such cases, a global binding asserts that the correspondence is true in all locations. A typical global term binding section resembles the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">term_bindings = &lt;
    ["umls"] = &lt;
        items =&lt;
            ["at0000"] = &lt;[umls::C124305]&gt; -- apgar result
            ["at0002"] = &lt;[umls::0000000]&gt; -- 1-minute event
            ["at0004"] = &lt;[umls::C234305]&gt; -- cardiac score
            ["at0005"] = &lt;[umls::C232405]&gt; -- respiratory score
            ["at0006"] = &lt;[umls::C254305]&gt; -- muscle tone score
            ["at0007"] = &lt;[umls::C987305]&gt; -- reflex response score
            ["at0008"] = &lt;[umls::C189305]&gt; -- color score
            ["at0009"] = &lt;[umls::C187305]&gt; -- apgar score
            ["at0010"] = &lt;[umls::C325305]&gt; -- 2-minute apgar
            ["at0011"] = &lt;[umls::C725354]&gt; -- 5-minute apgar
            ["at0012"] = &lt;[umls::C224305]&gt; -- 10-minute apgar
        &gt;
    &gt;
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each entry indicates which term in an external terminology is equivalent to the archetype internal codes. Note that not all internal codes necessarily have equivalents: for this reason, a terminology binding is assumed to be valid even if it does not contain all of the internal codes.</p>
</div>
</div>
<div class="sect3">
<h4 id="_path_based_bindings"><a class="anchor" href="#_path_based_bindings"></a><a class="link" href="#_path_based_bindings">Path-based Bindings</a></h4>
<div class="paragraph">
<p>The second kind of binding is one between an archetype path and an external code. This occurs commonly for archetypes where a term us re-used at the leaf level. For example, in the binding example below, the at0004 code represents 'temperature' and the codes <code>at0003</code>, <code>at0005</code>, <code>at0006</code> etc correspond to various times such as 'any', 1-hour average, 1-hour maximum and so on. Some terminologies (notably <a href="http://loinc.org">LOINC</a>, the laboratory terminology in this example) define 'pre-coordinated' codes, such as '1 hour body temperature'; these clearly correspond not to single codes such as at0004 in the archetype, but to whole paths. In such cases, the key in each term binding row is a full path rather than a single term.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">["LNC205"] = &lt;
    items = &lt;
        ["/data[at0002]/events[at0003]/data[at0001]/item[at0004]"] = &lt;[LNC205::8310-5]&gt;
        ["/data[at0002]/events[at0005]/data[at0001]/item[at0004]"] = &lt;[LNC205::8321-2]&gt;
        ["/data[at0002]/events[at0006]/data[at0001]/item[at0004]"] = &lt;[LNC205::8311-3]&gt;
        ["/data[at0002]/events[at0007]/data[at0001]/item[at0004]"] = &lt;[LNC205::8316-2]&gt;
        ["/data[at0002]/events[at0008]/data[at0001]/item[at0004]"] = &lt;[LNC205::8332-0]&gt;
        ["/data[at0002]/events[at0009]/data[at0001]/item[at0004]"] = &lt;[LNC205::8312-1]&gt;
        ["/data[at0002]/events[at0017]/data[at0001]/item[at0004]"] = &lt;[LNC205::8325-3]&gt;
        ["/data[at0002]/events[at0019]/data[at0001]/item[at0004]"] = &lt;[LNC205::8320-4]&gt;
    &gt;
&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_constraint_bindings_section"><a class="anchor" href="#_constraint_bindings_section"></a><a class="link" href="#_constraint_bindings_section">Constraint_bindings Section</a></h3>
<div class="paragraph">
<p>The last of the <code>ontology</code> sections formally describes bindings to placeholder constraints (see <a href="#Placeholder Constraints">[Placeholder Constraints]</a>) from the main archetype body. They are described separately because they are terminology-dependent, and because there may be more than one for a given logical constraint. A typical example follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-odin" data-lang="odin">constraint_bindings = &lt;
    ["snomed_ct"] = &lt;
        items = &lt;
            ["ac0001"] = &lt;http://terminology.org?query_id=12345&gt;
            ["ac0002"] = &lt;http://terminology.org?query_id=678910&gt;
        &gt;
    &gt;
&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, each local constraint code is formally defined to refer to a query defined in a terminology service, in this case, a terminology service that can interrogate the Snomed-CT terminology.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_revision_history_section"><a class="anchor" href="#_revision_history_section"></a><a class="link" href="#_revision_history_section">Revision History Section</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The revision history section of an archetype shows the audit history of changes to the archetype, and is expressed in dADL syntax. It is optional, and is included at the end of the archetype, since it does not contain content of direct interest to archetype authors, and will monotonically grow in size. Where archetypes are stored in a version-controlled repository such as CVS or some commercial product, the revision history section would normally be regenerated each time by the authoring software, e.g. via processing of the output of the 'prs' command used with SCCS files, or 'rlog' for RCS files. The following shows a typical example, with entries in most-recent-first order (although technically speaking, the order is irrelevant to ADL).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-adl" data-lang="adl">revision_history
    revision_history = &lt;
        ["1.57"] = &lt;
            committer = &lt;"Miriam Hanoosh"&gt;
            committer_organisation = &lt;"AIHW.org.au"&gt;
            time_committed = &lt;2004-11-02 09:31:04+1000&gt;
            revision = &lt;"1.2"&gt;
            reason = &lt;"Added social history section"&gt;
            change_type = &lt;"Modification"&gt;
        &gt;
        -- etc
        ["1.1"] = &lt;
            committer = &lt;"Enrico Barrios"&gt;
            committer_organisation = &lt;"AIHW.org.au"&gt;
            time_committed = &lt;2004-09-24 11:57:00+1000&gt;
            revision = &lt;"1.1"&gt;
            reason = &lt;"Updated HbA1C test result reference"&gt;
            change_type = &lt;"Modification"&gt;
        &gt;
        ["1.0"] = &lt;
            committer = &lt;"Enrico Barrios"&gt;
            committer_organisation = &lt;"AIHW.org.au"&gt;
            time_committed = &lt;2004-09-14 16:05:00+1000&gt;
            revision = &lt;"1.0"&gt;
            reason = &lt;"Initial Writing"&gt;
            change_type = &lt;"Creation"&gt;
        &gt;
    &gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validity_rules"><a class="anchor" href="#_validity_rules"></a><a class="link" href="#_validity_rules">Validity Rules</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the formal (i.e. checkable) semantics of ADL archetypes. It is recommended that parsing tools use the identifiers published here in their error messages, as an aid to archetype designers.</p>
</div>
<div class="sect2">
<h3 id="_global_archetype_validity"><a class="anchor" href="#_global_archetype_validity"></a><a class="link" href="#_global_archetype_validity">Global Archetype Validity</a></h3>
<div class="paragraph">
<p>The following validity constraints apply to an archetype as a whole. Note that the term "section" means the same as "attribute" in the following, i.e. a section called "definition" in a dADL text is a serialisation of the value for the attribute of the same name.</p>
</div>
<div class="paragraph rule">
<p><strong>VARID</strong>: archetype identifier validity. The archetype must have an identifier value for the archetype_id section. The identifier must conform to the published openEHR specification for archetype identifiers.</p>
</div>
<div class="paragraph rule">
<p><strong>VARCN</strong>: archetype concept validity. The archetype must have an archetype term value in the concept section. The term must exist in the archetype ontology.</p>
</div>
<div class="paragraph rule">
<p><strong>VARDF</strong>: archetype definition validity. The archetype must have a definition section, expressed as a cADL syntax string, or in an equivalent plug-in syntax.</p>
</div>
<div class="paragraph rule">
<p><strong>VARON</strong>: archetype ontology validity. The archetype must have an ontology section, expressed as a cADL syntax string, or in an equivalent plug-in syntax.</p>
</div>
<div class="paragraph rule">
<p><strong>VARDT</strong>: archetype definition typename validity. The topmost typename mentioned in the archetype definition section must match the type mentioned in the type-name slot of the first segment of the archetype id.</p>
</div>
</div>
<div class="sect2">
<h3 id="_coded_term_validity"><a class="anchor" href="#_coded_term_validity"></a><a class="link" href="#_coded_term_validity">Coded Term Validity</a></h3>
<div class="paragraph">
<p>All node identifiers ('at' codes) used in the definition part of the archetype must be defined in the term_definitions part of the ontology.</p>
</div>
<div class="paragraph rule">
<p><strong>VATDF</strong>: archetype term validity. Each archetype term used as a node identifier the archetype definition must be defined in the term_definitions part of the ontology. All constraint identifiers ('ac' codes) used in the definition part of the archetype must be defined in the constraint_definitions part of the ontology.</p>
</div>
<div class="paragraph rule">
<p><strong>VACDF</strong>: node identifier validity. Each constraint code used in the archetype definition part must be defined in the constraint_definitions part of the ontology.</p>
</div>
</div>
<div class="sect2">
<h3 id="_definition_section_2"><a class="anchor" href="#_definition_section_2"></a><a class="link" href="#_definition_section_2">Definition Section</a></h3>
<div class="paragraph">
<p>The following constraints apply to the definition section of the archetype.</p>
</div>
<div class="paragraph rule">
<p><strong>VDFAI</strong>: archetype identifier validity in definition. Any archetype identifier mentioned in an archetype slot in the definition section must conform to the published openEHR specification for archetype identifiers.</p>
</div>
<div class="paragraph rule">
<p><strong>VDFPT</strong>: path validity in definition. Any path mentioned in the definition section must be valid syntactically, and a valid path with respect to the hierarchical structure of the definition section.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_syntax_specification"><a class="anchor" href="#_syntax_specification"></a><a class="link" href="#_syntax_specification">Syntax Specification</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following syntax and lexical specification are used to process an entire ADL file. Their main job is reading the header items, and then cutting it up into dADL, cADL and assertion sections.</p>
</div>
<div class="paragraph">
<p>The ADL grammar is implemented and tested using lex (.l file) and yacc (.y file) specifications for in the Eiffel programming environment. The 1.4 release of these files is available in the <a href="https://github.com/openEHR/adl-tools/tree/Release-1.4/components/adl_parser/src/syntax/adl/parser">ADL grammar files</a>. The .l and .y files can be converted for use in another yacc/lex-based programming environment.</p>
</div>
<div class="sect2">
<h3 id="_grammar"><a class="anchor" href="#_grammar"></a><a class="link" href="#_grammar">Grammar</a></h3>
<div class="paragraph">
<p>This section describes the ADL grammar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-antlr-java" data-lang="antlr-java">archetype:
    arch_identification
    arch_specialisation
    arch_concept
    arch_language
    arch_description
    arch_definition
    arch_invariant
    arch_ontology
    ;

arch_identification:
    arch_head V_ARCHETYPE_ID
    ;

arch_head:
    SYM_ARCHETYPE
    | SYM_ARCHETYPE arch_meta_data
    ;

arch_meta_data:
    '(' arch_meta_data_items ')'
    ;

arch_meta_data_items:
    arch_meta_data_item
    | arch_meta_data_items ';' arch_meta_data_item
    ;

arch_meta_data_item:
    SYM_ADL_VERSION '=' V_VERSION_STRING
    | SYM_IS_CONTROLLED
    ;

arch_specialisation:
    // empty OK
    | SYM_SPECIALIZE V_ARCHETYPE_ID
    ;

arch_concept:
    SYM_CONCEPT V_LOCAL_TERM_CODE_REF
    | SYM_CONCEPT error
    ;

arch_language:
    // empty OK
    | SYM_LANGUAGE V_DADL_TEXT
    ;

arch_description:
    // empty OK
    | SYM_DESCRIPTION V_DADL_TEXT
    ;

arch_definition:
    SYM_DEFINITION V_CADL_TEXT
    ;

arch_invariant:
    // empty OK
    | SYM_INVARIANT V_ASSERTION_TEXT

arch_ontology:
    SYM_ONTOLOGY V_DADL_TEXT
    ;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_symbols"><a class="anchor" href="#_symbols"></a><a class="link" href="#_symbols">Symbols</a></h3>
<div class="paragraph">
<p>The following shows the ADL lexical specification.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>----------/* symbols */ -------------------------------------------------
"-"     Minus_code
"+"     Plus_code
"*"     Star_code
"/"     Slash_code
"^"     Caret_code
"="     Equal_code
"."     Dot_code
";"     Semicolon_code
","     Comma_code
":"     Colon_code
"!"     Exclamation_code
"("     Left_parenthesis_code
")"     Right_parenthesis_code
"$"     Dollar_code
"?"     Question_mark_code
"["     Left_bracket_code
"]"     Right_bracket_code

----------/* keywords */ -------------------------------------------------
^[Aa][Rr][Cc][Hh][Ee][Tt][Yy][Pp][Ee][ \t\r]*\n         SYM_ARCHETYPE
^[Ss][Pp][Ee][Cc][Ii][Aa][Ll][Ii][SsZz][Ee][ \t\r]*\n   SYM_SPECIALIZE
^[Cc][Oo][Nn][Cc][Ee][Pp][Tt][ \t\r]*\n                 SYM_CONCEPT
^[Dd][Ee][Ff][Ii][Nn][Ii][Tt][Ii][Oo][Nn][ \t\r]*\n     SYM_DEFINITION

-- mini-parser to match V_DADL_TEXT
^[Ll][Aa][Nn][Gg][Uu][Aa][Gg][Ee][ \t\r]*\n             SYM_LANGUAGE

-- mini-parser to match V_DADL_TEXT
^[Dd][Ee][Ss][Cc][Rr][Ii][Pp][Tt][Ii][Oo][Nn][ \t\r]*\n SYM_DESCRIPTION

-- mini-parser to match V_CADL_TEXT
^[Ii][Nn][Vv][Aa][Rr][Ii][Aa][Nn][Tt][ \t\r]*\n         SYM_INVARIANT

-- mini-parser to match V_ASSERTION_TEXT
^[Oo][Nn][Tt][Oo][Ll][Oo][Gg][Yy][ \t\r]*\n SYM_ONTOLOGY

-- mini-parser to match V_DADL_TEXT
----------/* V_DADL_TEXT */ -------------------------------------
&lt;IN_DADL_SECTION&gt;{
    -- the following 2 patterns are a hack, until ADL2 comes into being;
    -- until then, dADL blocks in an archetype finish when they
    -- hit EOF, or else the 'description' or 'definition' keywords.
    -- It's not nice, but it's simple ;-)
    -- For both these patterns, the lexer has to unread what it
    -- has just matched, store the dADL text so far, then get out
    -- of the IN_DADL_SECTION state
    ^[Dd][Ee][Ff][Ii][Nn][Ii][Tt][Ii][Oo][Nn][ \t\r]*\n
    ^[Dd][Ee][Sc][Rr][Ii][Pp][Tt][Ii][Oo][Nn][ \t\r]*\n
    [^\n]+\n            -- any text on line with a LF
    [^\n]+              -- any text on line with no LF
    &lt;&lt;EOF&gt;&gt;             -- (escape condition)
    (.|\n)              -- ignore unmatched chars
}

----------/* V_CADL_TEXT */ -------------------------------------
&lt;IN_CADL_SECTION&gt;{
    ^[ \t]+[^\n]*\n -- non-blank lines
    \n+ -- blank lines
    ^[^ \t] -- non-white space at start (escape condition)
}

----------/* V_ASSERTION_TEXT */ -------------------------------------
&lt;IN_ASSERTION_SECTION&gt;{
    ^[ \t]+[^\n]*\n -- non-blank lines
    ^[^ \t] -- non-white space at start (escape condition)
}

----------/* V_VERSION_STRING */ -------------------------------------
[0-9]+\.[0-9]+(\.[0-9]+)*

----------/* V_LOCAL_TERM_CODE_REF */ --------------------------------------
\[[a-zA-Z0-9][a-zA-Z0-9.-]*\]

----------/* V_ARCHETYPE_ID */ ---------------------------------------------
[a-zA-Z][a-zA-Z0-9_]+(-[a-zA-Z][a-zA-Z0-9_]+){2}\.[a-zA-Z][a-zA-Z0-9_]+(-[azA-Z][a-zA-Z0-9_]+)*\.v[1-9][0-9]*

----------/* V_IDENTIFIER */ ----------------------------------------------
[a-zA-Z][a-zA-Z0-9_]*</pre>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../paths/">ADL Paths</a></span>
  <span class="next"><a href="../customising_adl/">Customising ADL</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>
    Copyright: © 2003+
    <a href="https://www.openehr.org"
        alt="is an independent, non-profit foundation, facilitating the sharing of health
           records by consumers and clinicians via open specifications, clinical models
           and open platform implementations.">The openEHR Foundation</a>
  </p>

  <p>
    License:
    <img src="../../../../ui/img/cc-by-nd-88x31.png"
        alt="Creative Commons Attribution-NoDerivs 3.0 Unported."
        style="vertical-align:middle;margin:0 0.25rem 0 0;">
    <a href="https://creativecommons.org/licenses/by-nd/3.0/">
      Creative Commons Attribution-NoDerivs 3.0 Unported.
    </a>
  </p>

  <p>
    <strong>Links: <strong>
    <a href="https://www.openehr.org/terms-of-use" class="mr-1">Terms of use</a> |
    <a href="https://www.openehr.org/privacy-policy" class="mx-1">Privacy policy</a> |
    <a href="https://www.openehr.org/privacy-policy" class="mx-1">Logos &amp; Trademarks</a> |
    <a href="https://www.openehr.org/contact-us" class="mx-1">Contact</a>
  </p>
</footer>

<script id="site-script" src="../../../../ui/js/site.js" data-ui-root-path="../../../../ui"></script>
<script async src="../../../../ui/js/vendor/highlight.js"></script>
<script src="../../../../ui/js/vendor/lunr.js"></script>
<script src="../../../../ui/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="80" data-stylesheet="../../../../ui/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
<script src="../../../../ui/js/medium-zoom.min.js"></script>
<script src="../../../../ui/js/zoom.js"></script>
  </body>
</html>
